{"ast":null,"code":"import React,{useState,useEffect}from'react';import Chat from'./components/Chat';import ReflectionView from'./components/Reflection/ReflectionView';import PersonaView from'./components/Persona/PersonaView';import ErrorBoundary from'./components/ErrorBoundary';import NavSidebar from'./components/Layout/NavSidebar';import DiagnosticsBanner from'./components/System/DiagnosticsBanner';import LicenseStatus from'./components/LicenseStatus';import LicenseExpiryModal from'./components/LicenseExpiryModal';import{getOrCreateSessionId}from'./services/sessionService';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[activeTab,setActiveTab]=useState('chat');const[userId,setUserId]=useState('');const[licenseExpired,setLicenseExpired]=useState(false);const[expiryMessage,setExpiryMessage]=useState('');const[expiredAtRuntime,setExpiredAtRuntime]=useState(false);// Generate/retrieve a stable session/user ID via centralized service\nuseEffect(()=>{const id=getOrCreateSessionId();setUserId(id);},[]);// Listen for license expiry events\nuseEffect(()=>{const handleLicenseExpiry=event=>{console.log('License expired event received:',event.detail);setExpiryMessage(event.detail.message||'Your 30-day beta trial has expired.');setExpiredAtRuntime(event.detail.expired_at_runtime||false);setLicenseExpired(true);};window.addEventListener('licenseExpired',handleLicenseExpiry);return()=>{window.removeEventListener('licenseExpired',handleLicenseExpiry);};},[]);const handleCloseExpiryModal=()=>{setLicenseExpired(false);// If expired at runtime, we'll reload the page anyway\nif(!expiredAtRuntime){// For startup expiry, we might want to close the app or show a different state\nconsole.log('License expired - application should be closed');}};return/*#__PURE__*/_jsxs(ErrorBoundary,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-[var(--color-bg)] text-[var(--color-text-primary)] flex\",children:[/*#__PURE__*/_jsx(NavSidebar,{activeTab:activeTab,onChange:setActiveTab}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 flex flex-col\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"h-16 border-b border-[var(--color-border)] flex items-center justify-between px-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col leading-tight\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-base font-semibold text-[var(--color-text-primary)]\",children:\"SELO DSP\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(LicenseStatus,{}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-[var(--color-text-muted)]\",children:new Date().getFullYear()})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"md:hidden border-b border-[var(--color-border)] px-3 py-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-3 gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{className:`text-sm px-3 py-2 rounded border transition-colors ${activeTab==='chat'?'border-[var(--color-accent)] text-[var(--color-accent)] bg-[var(--color-bg-elev-2)]':'border-[var(--color-border)] text-[var(--color-text-secondary)] hover:bg-[var(--color-bg-elev-2)]'}`,onClick:()=>setActiveTab('chat'),\"aria-current\":activeTab==='chat'?'page':undefined,children:\"Chat\"}),/*#__PURE__*/_jsx(\"button\",{className:`text-sm px-3 py-2 rounded border transition-colors ${activeTab==='reflection'?'border-[var(--color-accent)] text-[var(--color-accent)] bg-[var(--color-bg-elev-2)]':'border-[var(--color-border)] text-[var(--color-text-secondary)] hover:bg-[var(--color-bg-elev-2)]'}`,onClick:()=>setActiveTab('reflection'),\"aria-current\":activeTab==='reflection'?'page':undefined,children:\"Reflections\"}),/*#__PURE__*/_jsx(\"button\",{className:`text-sm px-3 py-2 rounded border transition-colors ${activeTab==='persona'?'border-[var(--color-accent)] text-[var(--color-accent)] bg-[var(--color-bg-elev-2)]':'border-[var(--color-border)] text-[var(--color-text-secondary)] hover:bg-[var(--color-bg-elev-2)]'}`,onClick:()=>setActiveTab('persona'),\"aria-current\":activeTab==='persona'?'page':undefined,children:\"Persona\"})]})}),/*#__PURE__*/_jsx(DiagnosticsBanner,{}),/*#__PURE__*/_jsx(\"main\",{className:\"flex-1 p-4 overflow-y-auto\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-6xl mx-auto\",children:activeTab==='chat'?/*#__PURE__*/_jsx(ErrorBoundary,{children:/*#__PURE__*/_jsx(Chat,{userId:userId})}):activeTab==='reflection'?/*#__PURE__*/_jsx(ErrorBoundary,{children:/*#__PURE__*/_jsx(ReflectionView,{userId:userId})}):/*#__PURE__*/_jsx(ErrorBoundary,{children:/*#__PURE__*/_jsx(PersonaView,{userId:userId})})})})]})]}),/*#__PURE__*/_jsx(LicenseExpiryModal,{isOpen:licenseExpired,onClose:handleCloseExpiryModal,message:expiryMessage,expiredAtRuntime:expiredAtRuntime})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","Chat","ReflectionView","PersonaView","ErrorBoundary","NavSidebar","DiagnosticsBanner","LicenseStatus","LicenseExpiryModal","getOrCreateSessionId","jsx","_jsx","jsxs","_jsxs","App","activeTab","setActiveTab","userId","setUserId","licenseExpired","setLicenseExpired","expiryMessage","setExpiryMessage","expiredAtRuntime","setExpiredAtRuntime","id","handleLicenseExpiry","event","console","log","detail","message","expired_at_runtime","window","addEventListener","removeEventListener","handleCloseExpiryModal","children","className","onChange","Date","getFullYear","onClick","undefined","isOpen","onClose"],"sources":["/mnt/local/Projects/SELODSP1/selo-ai/frontend/src/App.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport Chat from './components/Chat';\nimport ReflectionView from './components/Reflection/ReflectionView';\nimport PersonaView from './components/Persona/PersonaView';\nimport ErrorBoundary from './components/ErrorBoundary';\nimport NavSidebar from './components/Layout/NavSidebar';\nimport DiagnosticsBanner from './components/System/DiagnosticsBanner';\nimport LicenseStatus from './components/LicenseStatus';\nimport LicenseExpiryModal from './components/LicenseExpiryModal';\nimport { getOrCreateSessionId } from './services/sessionService';\n\nfunction App() {\n  const [activeTab, setActiveTab] = useState('chat');\n  const [userId, setUserId] = useState('');\n  const [licenseExpired, setLicenseExpired] = useState(false);\n  const [expiryMessage, setExpiryMessage] = useState('');\n  const [expiredAtRuntime, setExpiredAtRuntime] = useState(false);\n\n  // Generate/retrieve a stable session/user ID via centralized service\n  useEffect(() => {\n    const id = getOrCreateSessionId();\n    setUserId(id);\n  }, []);\n\n  // Listen for license expiry events\n  useEffect(() => {\n    const handleLicenseExpiry = (event) => {\n      console.log('License expired event received:', event.detail);\n      setExpiryMessage(event.detail.message || 'Your 30-day beta trial has expired.');\n      setExpiredAtRuntime(event.detail.expired_at_runtime || false);\n      setLicenseExpired(true);\n    };\n\n    window.addEventListener('licenseExpired', handleLicenseExpiry);\n    \n    return () => {\n      window.removeEventListener('licenseExpired', handleLicenseExpiry);\n    };\n  }, []);\n\n  const handleCloseExpiryModal = () => {\n    setLicenseExpired(false);\n    \n    // If expired at runtime, we'll reload the page anyway\n    if (!expiredAtRuntime) {\n      // For startup expiry, we might want to close the app or show a different state\n      console.log('License expired - application should be closed');\n    }\n  };\n\n  return (\n    <ErrorBoundary>\n      <div className=\"min-h-screen bg-[var(--color-bg)] text-[var(--color-text-primary)] flex\">\n        {/* Sidebar */}\n        <NavSidebar activeTab={activeTab} onChange={setActiveTab} />\n\n        {/* Main content area */}\n        <div className=\"flex-1 flex flex-col\">\n          {/* Minimal header */}\n          <header className=\"h-16 border-b border-[var(--color-border)] flex items-center justify-between px-4\">\n            <div className=\"flex flex-col leading-tight\">\n              <div className=\"text-base font-semibold text-[var(--color-text-primary)]\">SELO DSP</div>\n            </div>\n            <div className=\"flex items-center gap-4\">\n              <LicenseStatus />\n              <div className=\"text-xs text-[var(--color-text-muted)]\">{new Date().getFullYear()}</div>\n            </div>\n          </header>\n\n          {/* Mobile tab switcher (sidebar hidden on mobile) */}\n          <div className=\"md:hidden border-b border-[var(--color-border)] px-3 py-2\">\n            <div className=\"grid grid-cols-3 gap-2\">\n              <button\n                className={`text-sm px-3 py-2 rounded border transition-colors ${activeTab==='chat' ? 'border-[var(--color-accent)] text-[var(--color-accent)] bg-[var(--color-bg-elev-2)]' : 'border-[var(--color-border)] text-[var(--color-text-secondary)] hover:bg-[var(--color-bg-elev-2)]'}`}\n                onClick={() => setActiveTab('chat')}\n                aria-current={activeTab==='chat' ? 'page' : undefined}\n              >Chat</button>\n              <button\n                className={`text-sm px-3 py-2 rounded border transition-colors ${activeTab==='reflection' ? 'border-[var(--color-accent)] text-[var(--color-accent)] bg-[var(--color-bg-elev-2)]' : 'border-[var(--color-border)] text-[var(--color-text-secondary)] hover:bg-[var(--color-bg-elev-2)]'}`}\n                onClick={() => setActiveTab('reflection')}\n                aria-current={activeTab==='reflection' ? 'page' : undefined}\n              >Reflections</button>\n              <button\n                className={`text-sm px-3 py-2 rounded border transition-colors ${activeTab==='persona' ? 'border-[var(--color-accent)] text-[var(--color-accent)] bg-[var(--color-bg-elev-2)]' : 'border-[var(--color-border)] text-[var(--color-text-secondary)] hover:bg-[var(--color-bg-elev-2)]'}`}\n                onClick={() => setActiveTab('persona')}\n                aria-current={activeTab==='persona' ? 'page' : undefined}\n              >Persona</button>\n            </div>\n          </div>\n\n          {/* Diagnostics banner (GPU/CPU status) */}\n          <DiagnosticsBanner />\n\n          {/* Content */}\n          <main className=\"flex-1 p-4 overflow-y-auto\">\n            <div className=\"max-w-6xl mx-auto\">\n              {/* Individual ErrorBoundaries for each tab to prevent one view from crashing others */}\n              {activeTab === 'chat' ? (\n                <ErrorBoundary>\n                  <Chat userId={userId} />\n                </ErrorBoundary>\n              ) : activeTab === 'reflection' ? (\n                <ErrorBoundary>\n                  <ReflectionView userId={userId} />\n                </ErrorBoundary>\n              ) : (\n                <ErrorBoundary>\n                  <PersonaView userId={userId} />\n                </ErrorBoundary>\n              )}\n            </div>\n          </main>\n        </div>\n      </div>\n      \n      {/* License Expiry Modal */}\n      <LicenseExpiryModal\n        isOpen={licenseExpired}\n        onClose={handleCloseExpiryModal}\n        message={expiryMessage}\n        expiredAtRuntime={expiredAtRuntime}\n      />\n    </ErrorBoundary>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}