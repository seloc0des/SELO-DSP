{"ast":null,"code":"import React,{useState,useEffect,useCallback,useMemo,useRef}from'react';import{reflectionService}from'../services/reflectionService';import ErrorBoundary from'./ErrorBoundary';import ReflectionCard from'./Reflection/ReflectionCard';import{formatRelativeTime}from'../utils/dateFormatter';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ReflectionPanel=_ref=>{let{sessionId,messages}=_ref;// Load reflections from localStorage on mount (if available for this session)\nconst getStoredReflections=useCallback(()=>{try{const key=`reflections_${sessionId}`;const stored=localStorage.getItem(key);return stored?JSON.parse(stored):[];}catch(e){console.warn('Failed to load reflections from localStorage:',e);return[];}},[sessionId]);const[reflections,setReflections]=useState(getStoredReflections);// Only show loading spinner if we have no cached data\nconst[loading,setLoading]=useState(()=>getStoredReflections().length===0);const[error,setError]=useState(null);const[connectionStatus,setConnectionStatus]=useState('connecting');const[isPolling,setIsPolling]=useState(false);const[page,setPage]=useState(1);const[hasMore,setHasMore]=useState(true);const[retryCount,setRetryCount]=useState(0);const[reflectingCount,setReflectingCount]=useState(0);// Persist reflections to localStorage whenever they change\nuseEffect(()=>{if(reflections.length>0){const saveToLocalStorage=()=>{const key=`reflections_${sessionId}`;try{localStorage.setItem(key,JSON.stringify(reflections));// Store timestamp for this session\nlocalStorage.setItem(`${key}_timestamp`,new Date().toISOString());return true;}catch(e){if(e.name==='QuotaExceededError'){// Proactively clean up old data when quota exceeded\ntry{const allKeys=Object.keys(localStorage);const reflectionKeys=allKeys.filter(k=>k.startsWith('reflections_')&&k!==key).slice(0,Math.floor(allKeys.length/2));// Remove old reflection data\nreflectionKeys.forEach(k=>{localStorage.removeItem(k);localStorage.removeItem(`${k}_timestamp`);});// Retry save after cleanup\nlocalStorage.setItem(key,JSON.stringify(reflections));localStorage.setItem(`${key}_timestamp`,new Date().toISOString());return true;}catch(retryErr){console.error('Failed to save reflections even after cleanup:',retryErr);return false;}}else{console.warn('Failed to save reflections to localStorage:',e);return false;}}};const saved=saveToLocalStorage();// Periodic cleanup: Remove old reflection data (keep only last 3 sessions)\nif(saved&&Math.random()<0.1){// 10% chance to run cleanup\ntry{const allKeys=Object.keys(localStorage);const reflectionKeys=allKeys.filter(k=>k.startsWith('reflections_')).map(k=>({key:k.replace('_timestamp',''),timestamp:localStorage.getItem(`${k}_timestamp`)||'0'})).filter((item,index,self)=>index===self.findIndex(t=>t.key===item.key)).sort((a,b)=>b.timestamp.localeCompare(a.timestamp));// Keep only the 3 most recent sessions\nif(reflectionKeys.length>3){reflectionKeys.slice(3).forEach(_ref2=>{let{key}=_ref2;localStorage.removeItem(key);localStorage.removeItem(`${key}_timestamp`);});}}catch(cleanupErr){console.warn('Periodic cleanup failed:',cleanupErr);}}}},[reflections,sessionId]);const ITEMS_PER_PAGE=20;const MAX_RETRIES=3;// Memoized filtered reflections for current page\n// Only show message reflections (inner reflections), exclude scheduled tasks and internal seeds\nconst paginatedReflections=useMemo(()=>{const messageReflections=reflections.filter(r=>{const type=r.reflection_type||r.type;return type==='message';});return messageReflections.slice(0,page*ITEMS_PER_PAGE);},[reflections,page]);// Use ref to store initialization function to avoid dependency issues\nconst initializeReflectionsRef=useRef();initializeReflectionsRef.current=async()=>{try{setLoading(true);setError(null);// Fetch initial reflections and filter to message type only\nconst initialReflections=await reflectionService.getReflections(sessionId);const messageReflections=(initialReflections||[]).filter(r=>{const type=r.reflection_type||r.type;return type==='message';});setReflections(messageReflections);setHasMore(messageReflections.length>=ITEMS_PER_PAGE);setLoading(false);setRetryCount(0);// Reset retry count on success\n// Set up real-time updates\nconst unsubscribe=reflectionService.onReflectionGenerated(evt=>{// evt may be a wrapped event with status 'generating' | 'complete'\nconst base=evt||{};if(base.status==='generating'){setReflectingCount(c=>c+1);}const payload=(base===null||base===void 0?void 0:base.data)||base;if(!payload)return;if(!payload.user_profile_id||payload.user_profile_id===sessionId){if(base.status==='complete'){setReflectingCount(c=>Math.max(0,c-1));// Only add message reflections, skip scheduled tasks and internal seeds\nconst type=payload.reflection_type||payload.type;if(type==='message'){setReflections(prev=>{const newId=payload.reflection_id||base.reflectionId;const exists=prev.some(r=>(r.reflection_id||r.reflectionId)===newId);return exists?prev:[payload,...prev];});}}}},sessionId);// Return cleanup for the caller if needed\nreturn()=>{try{unsubscribe&&unsubscribe();}catch(e){/* noop */}};}catch(err){console.error('Failed to initialize reflections:',err);setError(err.message||'Failed to load reflections');setLoading(false);}};const handleRetry=useCallback(async()=>{if(retryCount<MAX_RETRIES){setRetryCount(prev=>prev+1);setError(null);setLoading(true);await initializeReflectionsRef.current();}},[retryCount]);// Subscribe to connection status once (mount/unmount)\nuseEffect(()=>{const unsubscribeConn=reflectionService.subscribeToConnectionStatus(status=>{setConnectionStatus(status);setIsPolling(status==='polling');});return()=>{try{unsubscribeConn&&unsubscribeConn();}catch(e){/* noop */}};},[]);// Initialize reflections when session changes (do not depend on connectionStatus to avoid teardown loops)\nuseEffect(()=>{let mounted=true;let unsubscribeRefl=null;const setup=async()=>{if(!sessionId)return;unsubscribeRefl=await initializeReflectionsRef.current();};setup();return()=>{try{unsubscribeRefl&&unsubscribeRefl();}catch(e){/* noop */}// Intentionally do NOT disconnect the socket here; let the service manage its lifecycle\n};},[sessionId]);// Manage polling separately based on connection status without tearing down the socket\nuseEffect(()=>{let pollInterval=null;if(!sessionId)return undefined;if(connectionStatus==='offline'||connectionStatus==='polling'){pollInterval=setInterval(async()=>{try{const latestReflections=await reflectionService.getReflections(sessionId);// Filter to message reflections only\nconst messageReflections=(latestReflections||[]).filter(r=>{const type=r.reflection_type||r.type;return type==='message';});setReflections(messageReflections);}catch(err){console.error('Polling failed:',err);}},5000);}return()=>{if(pollInterval)clearInterval(pollInterval);};},[connectionStatus,sessionId]);const getConnectionStatusColor=()=>{switch(connectionStatus){case'connected':return'text-green-400';case'connecting':return'text-yellow-400';case'offline':return'text-red-400';case'polling':return'text-blue-400';default:return'text-gray-400';}};const getConnectionStatusText=()=>{if(isPolling)return'Polling';switch(connectionStatus){case'connected':return'Live';case'connecting':return'Connecting';case'offline':return'Offline';default:return'Unknown';}};const formatTimestamp=timestamp=>{if(!timestamp)return'Unknown time';try{const d=new Date(timestamp);if(isNaN(d.getTime()))return'Invalid time';return d.toLocaleString();}catch{return'Invalid time';}};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-md lg:max-w-lg bg-[var(--color-bg-elev-1)] border border-[var(--color-border)] rounded-lg p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-[var(--color-accent)]\",children:\"SELO's Inner Reflections\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-yellow-400 rounded-full animate-pulse\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-yellow-400\",children:\"Loading...\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:[...Array(3)].map((_,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"animate-pulse\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-4 bg-[var(--color-bg-elev-2)] rounded w-3/4 mb-2\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-3 bg-[var(--color-bg-elev-2)] rounded w-1/2\"})]},i))})]});}return/*#__PURE__*/_jsx(ErrorBoundary,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-md lg:max-w-lg bg-[var(--color-bg-elev-1)] border border-[var(--color-border)] rounded-lg p-3 sm:p-4 h-80 sm:h-96 flex flex-col\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-[var(--color-accent)]\",children:\"SELO's Inner Reflections\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:`w-2 h-2 rounded-full ${connectionStatus==='connected'?'bg-green-400':connectionStatus==='connecting'?'bg-yellow-400 animate-pulse':connectionStatus==='polling'?'bg-blue-400 animate-pulse':'bg-red-400'}`}),/*#__PURE__*/_jsx(\"span\",{className:`text-xs ${getConnectionStatusColor()}`,children:getConnectionStatusText()})]})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-3 bg-red-500/10 border border-red-500/30 rounded text-red-400 text-sm\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Error: \",error]}),retryCount<MAX_RETRIES&&/*#__PURE__*/_jsxs(\"button\",{onClick:handleRetry,className:\"ml-2 px-2 py-1 bg-red-500/20 hover:bg-red-500/30 rounded text-xs transition-colors\",children:[\"Retry (\",MAX_RETRIES-retryCount,\" left)\"]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 overflow-y-auto space-y-3\",children:[reflectingCount>0&&/*#__PURE__*/_jsx(\"div\",{className:\"p-3 bg-[var(--color-bg-elev-2)] rounded border border-[var(--color-border)]\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 text-[var(--color-accent)]\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-[var(--color-accent)] rounded-full animate-pulse\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"Reflecting\\u2026\"})]})}),paginatedReflections.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center text-[var(--color-text-muted)] py-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl mb-2\",children:\"\\uD83E\\uDD14\"}),/*#__PURE__*/_jsx(\"p\",{children:\"No reflections yet...\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs mt-1\",children:\"SELO will reflect on your conversation\"})]}):paginatedReflections.map((reflection,index)=>{const createdAt=reflection.created_at||reflection.timestamp;const timeAgo=formatRelativeTime(createdAt);return/*#__PURE__*/_jsx(ReflectionCard,{reflection:reflection,timeAgo:timeAgo},reflection.id||reflection.reflection_id||index);})]}),hasMore&&paginatedReflections.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 text-center\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>setPage(prev=>prev+1),className:\"px-4 py-2 text-[var(--color-accent)] border border-[var(--color-accent)] hover:bg-[var(--color-accent)] hover:text-black rounded text-sm transition-colors\",children:\"Load More\"})})]})});};export default ReflectionPanel;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useMemo","useRef","reflectionService","ErrorBoundary","ReflectionCard","formatRelativeTime","jsx","_jsx","jsxs","_jsxs","ReflectionPanel","_ref","sessionId","messages","getStoredReflections","key","stored","localStorage","getItem","JSON","parse","e","console","warn","reflections","setReflections","loading","setLoading","length","error","setError","connectionStatus","setConnectionStatus","isPolling","setIsPolling","page","setPage","hasMore","setHasMore","retryCount","setRetryCount","reflectingCount","setReflectingCount","saveToLocalStorage","setItem","stringify","Date","toISOString","name","allKeys","Object","keys","reflectionKeys","filter","k","startsWith","slice","Math","floor","forEach","removeItem","retryErr","saved","random","map","replace","timestamp","item","index","self","findIndex","t","sort","a","b","localeCompare","_ref2","cleanupErr","ITEMS_PER_PAGE","MAX_RETRIES","paginatedReflections","messageReflections","r","type","reflection_type","initializeReflectionsRef","current","initialReflections","getReflections","unsubscribe","onReflectionGenerated","evt","base","status","c","payload","data","user_profile_id","max","prev","newId","reflection_id","reflectionId","exists","some","err","message","handleRetry","unsubscribeConn","subscribeToConnectionStatus","mounted","unsubscribeRefl","setup","pollInterval","undefined","setInterval","latestReflections","clearInterval","getConnectionStatusColor","getConnectionStatusText","formatTimestamp","d","isNaN","getTime","toLocaleString","className","children","Array","_","i","onClick","reflection","createdAt","created_at","timeAgo","id"],"sources":["/mnt/local/Projects/SELODSP1/selo-ai/frontend/src/components/ReflectionPanel.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useMemo, useRef } from 'react';\nimport { reflectionService } from '../services/reflectionService';\nimport ErrorBoundary from './ErrorBoundary';\nimport ReflectionCard from './Reflection/ReflectionCard';\nimport { formatRelativeTime } from '../utils/dateFormatter';\n\nconst ReflectionPanel = ({ sessionId, messages }) => {\n  // Load reflections from localStorage on mount (if available for this session)\n  const getStoredReflections = useCallback(() => {\n    try {\n      const key = `reflections_${sessionId}`;\n      const stored = localStorage.getItem(key);\n      return stored ? JSON.parse(stored) : [];\n    } catch (e) {\n      console.warn('Failed to load reflections from localStorage:', e);\n      return [];\n    }\n  }, [sessionId]);\n\n  const [reflections, setReflections] = useState(getStoredReflections);\n  // Only show loading spinner if we have no cached data\n  const [loading, setLoading] = useState(() => getStoredReflections().length === 0);\n  const [error, setError] = useState(null);\n  const [connectionStatus, setConnectionStatus] = useState('connecting');\n  const [isPolling, setIsPolling] = useState(false);\n  const [page, setPage] = useState(1);\n  const [hasMore, setHasMore] = useState(true);\n  const [retryCount, setRetryCount] = useState(0);\n  const [reflectingCount, setReflectingCount] = useState(0);\n\n  // Persist reflections to localStorage whenever they change\n  useEffect(() => {\n    if (reflections.length > 0) {\n      const saveToLocalStorage = () => {\n        const key = `reflections_${sessionId}`;\n        try {\n          localStorage.setItem(key, JSON.stringify(reflections));\n          // Store timestamp for this session\n          localStorage.setItem(`${key}_timestamp`, new Date().toISOString());\n          return true;\n        } catch (e) {\n          if (e.name === 'QuotaExceededError') {\n            // Proactively clean up old data when quota exceeded\n            try {\n              const allKeys = Object.keys(localStorage);\n              const reflectionKeys = allKeys\n                .filter(k => k.startsWith('reflections_') && k !== key)\n                .slice(0, Math.floor(allKeys.length / 2));\n              \n              // Remove old reflection data\n              reflectionKeys.forEach(k => {\n                localStorage.removeItem(k);\n                localStorage.removeItem(`${k}_timestamp`);\n              });\n              \n              // Retry save after cleanup\n              localStorage.setItem(key, JSON.stringify(reflections));\n              localStorage.setItem(`${key}_timestamp`, new Date().toISOString());\n              return true;\n            } catch (retryErr) {\n              console.error('Failed to save reflections even after cleanup:', retryErr);\n              return false;\n            }\n          } else {\n            console.warn('Failed to save reflections to localStorage:', e);\n            return false;\n          }\n        }\n      };\n      \n      const saved = saveToLocalStorage();\n      \n      // Periodic cleanup: Remove old reflection data (keep only last 3 sessions)\n      if (saved && Math.random() < 0.1) { // 10% chance to run cleanup\n        try {\n          const allKeys = Object.keys(localStorage);\n          const reflectionKeys = allKeys\n            .filter(k => k.startsWith('reflections_'))\n            .map(k => ({\n              key: k.replace('_timestamp', ''),\n              timestamp: localStorage.getItem(`${k}_timestamp`) || '0'\n            }))\n            .filter((item, index, self) => \n              index === self.findIndex(t => t.key === item.key)\n            )\n            .sort((a, b) => b.timestamp.localeCompare(a.timestamp));\n          \n          // Keep only the 3 most recent sessions\n          if (reflectionKeys.length > 3) {\n            reflectionKeys.slice(3).forEach(({ key }) => {\n              localStorage.removeItem(key);\n              localStorage.removeItem(`${key}_timestamp`);\n            });\n          }\n        } catch (cleanupErr) {\n          console.warn('Periodic cleanup failed:', cleanupErr);\n        }\n      }\n    }\n  }, [reflections, sessionId]);\n\n  const ITEMS_PER_PAGE = 20;\n  const MAX_RETRIES = 3;\n\n  // Memoized filtered reflections for current page\n  // Only show message reflections (inner reflections), exclude scheduled tasks and internal seeds\n  const paginatedReflections = useMemo(() => {\n    const messageReflections = reflections.filter(r => {\n      const type = r.reflection_type || r.type;\n      return type === 'message';\n    });\n    return messageReflections.slice(0, page * ITEMS_PER_PAGE);\n  }, [reflections, page]);\n\n  // Use ref to store initialization function to avoid dependency issues\n  const initializeReflectionsRef = useRef();\n  initializeReflectionsRef.current = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n\n      // Fetch initial reflections and filter to message type only\n      const initialReflections = await reflectionService.getReflections(sessionId);\n      const messageReflections = (initialReflections || []).filter(r => {\n        const type = r.reflection_type || r.type;\n        return type === 'message';\n      });\n      setReflections(messageReflections);\n      setHasMore(messageReflections.length >= ITEMS_PER_PAGE);\n      setLoading(false);\n      setRetryCount(0); // Reset retry count on success\n\n      // Set up real-time updates\n      const unsubscribe = reflectionService.onReflectionGenerated((evt) => {\n        // evt may be a wrapped event with status 'generating' | 'complete'\n        const base = evt || {};\n        if (base.status === 'generating') {\n          setReflectingCount(c => c + 1);\n        }\n        const payload = base?.data || base;\n        if (!payload) return;\n        if (!payload.user_profile_id || payload.user_profile_id === sessionId) {\n          if (base.status === 'complete') {\n            setReflectingCount(c => Math.max(0, c - 1));\n            // Only add message reflections, skip scheduled tasks and internal seeds\n            const type = payload.reflection_type || payload.type;\n            if (type === 'message') {\n              setReflections(prev => {\n                const newId = payload.reflection_id || base.reflectionId;\n                const exists = prev.some(r => (r.reflection_id || r.reflectionId) === newId);\n                return exists ? prev : [payload, ...prev];\n              });\n            }\n          }\n        }\n      }, sessionId);\n\n      // Return cleanup for the caller if needed\n      return () => {\n        try { unsubscribe && unsubscribe(); } catch (e) { /* noop */ }\n      };\n    } catch (err) {\n      console.error('Failed to initialize reflections:', err);\n      setError(err.message || 'Failed to load reflections');\n      setLoading(false);\n    }\n  };\n\n  const handleRetry = useCallback(async () => {\n    if (retryCount < MAX_RETRIES) {\n      setRetryCount(prev => prev + 1);\n      setError(null);\n      setLoading(true);\n      await initializeReflectionsRef.current();\n    }\n  }, [retryCount]);\n\n  // Subscribe to connection status once (mount/unmount)\n  useEffect(() => {\n    const unsubscribeConn = reflectionService.subscribeToConnectionStatus((status) => {\n      setConnectionStatus(status);\n      setIsPolling(status === 'polling');\n    });\n    return () => {\n      try { unsubscribeConn && unsubscribeConn(); } catch (e) { /* noop */ }\n    };\n  }, []);\n\n  // Initialize reflections when session changes (do not depend on connectionStatus to avoid teardown loops)\n  useEffect(() => {\n    let mounted = true;\n    let unsubscribeRefl = null;\n\n    const setup = async () => {\n      if (!sessionId) return;\n      unsubscribeRefl = await initializeReflectionsRef.current();\n    };\n\n    setup();\n\n    return () => {\n      try { unsubscribeRefl && unsubscribeRefl(); } catch (e) { /* noop */ }\n      // Intentionally do NOT disconnect the socket here; let the service manage its lifecycle\n    };\n  }, [sessionId]);\n\n  // Manage polling separately based on connection status without tearing down the socket\n  useEffect(() => {\n    let pollInterval = null;\n    if (!sessionId) return undefined;\n    if (connectionStatus === 'offline' || connectionStatus === 'polling') {\n      pollInterval = setInterval(async () => {\n        try {\n          const latestReflections = await reflectionService.getReflections(sessionId);\n          // Filter to message reflections only\n          const messageReflections = (latestReflections || []).filter(r => {\n            const type = r.reflection_type || r.type;\n            return type === 'message';\n          });\n          setReflections(messageReflections);\n        } catch (err) {\n          console.error('Polling failed:', err);\n        }\n      }, 5000);\n    }\n\n    return () => {\n      if (pollInterval) clearInterval(pollInterval);\n    };\n  }, [connectionStatus, sessionId]);\n\n  const getConnectionStatusColor = () => {\n    switch (connectionStatus) {\n      case 'connected': return 'text-green-400';\n      case 'connecting': return 'text-yellow-400';\n      case 'offline': return 'text-red-400';\n      case 'polling': return 'text-blue-400';\n      default: return 'text-gray-400';\n    }\n  };\n\n  const getConnectionStatusText = () => {\n    if (isPolling) return 'Polling';\n    switch (connectionStatus) {\n      case 'connected': return 'Live';\n      case 'connecting': return 'Connecting';\n      case 'offline': return 'Offline';\n      default: return 'Unknown';\n    }\n  };\n\n  const formatTimestamp = (timestamp) => {\n    if (!timestamp) return 'Unknown time';\n    try {\n      const d = new Date(timestamp);\n      if (isNaN(d.getTime())) return 'Invalid time';\n      return d.toLocaleString();\n    } catch {\n      return 'Invalid time';\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"w-full max-w-md lg:max-w-lg bg-[var(--color-bg-elev-1)] border border-[var(--color-border)] rounded-lg p-4\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold text-[var(--color-accent)]\">SELO's Inner Reflections</h3>\n          <div className=\"flex items-center space-x-2\">\n            <div className=\"w-2 h-2 bg-yellow-400 rounded-full animate-pulse\"></div>\n            <span className=\"text-xs text-yellow-400\">Loading...</span>\n          </div>\n        </div>\n        <div className=\"space-y-3\">\n          {[...Array(3)].map((_, i) => (\n            <div key={i} className=\"animate-pulse\">\n              <div className=\"h-4 bg-[var(--color-bg-elev-2)] rounded w-3/4 mb-2\"></div>\n              <div className=\"h-3 bg-[var(--color-bg-elev-2)] rounded w-1/2\"></div>\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <ErrorBoundary>\n      <div className=\"w-full max-w-md lg:max-w-lg bg-[var(--color-bg-elev-1)] border border-[var(--color-border)] rounded-lg p-3 sm:p-4 h-80 sm:h-96 flex flex-col\">\n        {/* Header with connection status */}\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold text-[var(--color-accent)]\">SELO's Inner Reflections</h3>\n          <div className=\"flex items-center space-x-2\">\n            <div className={`w-2 h-2 rounded-full ${\n              connectionStatus === 'connected' ? 'bg-green-400' : \n              connectionStatus === 'connecting' ? 'bg-yellow-400 animate-pulse' : \n              connectionStatus === 'polling' ? 'bg-blue-400 animate-pulse' :\n              'bg-red-400'\n            }`}></div>\n            <span className={`text-xs ${getConnectionStatusColor()}`}>{getConnectionStatusText()}</span>\n          </div>\n        </div>\n\n        {/* Error state */}\n        {error && (\n          <div className=\"mb-4 p-3 bg-red-500/10 border border-red-500/30 rounded text-red-400 text-sm\">\n            <div className=\"flex items-center justify-between\">\n              <span>Error: {error}</span>\n              {retryCount < MAX_RETRIES && (\n                <button \n                  onClick={handleRetry}\n                  className=\"ml-2 px-2 py-1 bg-red-500/20 hover:bg-red-500/30 rounded text-xs transition-colors\"\n                >\n                  Retry ({MAX_RETRIES - retryCount} left)\n                </button>\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* Reflections list */}\n        <div className=\"flex-1 overflow-y-auto space-y-3\">\n          {reflectingCount > 0 && (\n            <div className=\"p-3 bg-[var(--color-bg-elev-2)] rounded border border-[var(--color-border)]\">\n              <div className=\"flex items-center space-x-2 text-[var(--color-accent)]\">\n                <div className=\"w-2 h-2 bg-[var(--color-accent)] rounded-full animate-pulse\"></div>\n                <span className=\"text-sm\">Reflectingâ€¦</span>\n              </div>\n            </div>\n          )}\n          {paginatedReflections.length === 0 ? (\n            <div className=\"text-center text-[var(--color-text-muted)] py-8\">\n              <div className=\"text-2xl mb-2\">ðŸ¤”</div>\n              <p>No reflections yet...</p>\n              <p className=\"text-xs mt-1\">SELO will reflect on your conversation</p>\n            </div>\n          ) : (\n            paginatedReflections.map((reflection, index) => {\n              const createdAt = reflection.created_at || reflection.timestamp;\n              const timeAgo = formatRelativeTime(createdAt);\n              \n              return (\n                <ReflectionCard\n                  key={reflection.id || reflection.reflection_id || index}\n                  reflection={reflection}\n                  timeAgo={timeAgo}\n                />\n              );\n            })\n          )}\n        </div>\n\n        {/* Load more button */}\n        {hasMore && paginatedReflections.length > 0 && (\n          <div className=\"mt-4 text-center\">\n            <button\n              onClick={() => setPage(prev => prev + 1)}\n              className=\"px-4 py-2 text-[var(--color-accent)] border border-[var(--color-accent)] hover:bg-[var(--color-accent)] hover:text-black rounded text-sm transition-colors\"\n            >\n              Load More\n            </button>\n          </div>\n        )}\n      </div>\n    </ErrorBoundary>\n  );\n};\n\nexport default ReflectionPanel;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}