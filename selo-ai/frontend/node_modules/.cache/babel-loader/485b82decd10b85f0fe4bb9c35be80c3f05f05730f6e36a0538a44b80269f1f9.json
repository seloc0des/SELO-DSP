{"ast":null,"code":"import React,{useState,useEffect}from'react';import'./LicenseStatus.css';import{getApiBaseUrl}from'../services/config';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const LicenseStatus=()=>{const[licenseInfo,setLicenseInfo]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const fetchLicenseStatus=async()=>{try{setLoading(true);const apiBase=await getApiBaseUrl();const response=await fetch(`${apiBase}/license/status`);// Check if we got a license expired response\nif(response.status===403){const errorData=await response.json();if(errorData.error==='license_expired'){setLicenseInfo({is_valid:false,message:errorData.message,days_remaining:0,is_beta:true,expired_at_runtime:true});setError(null);// Trigger app-wide license expiry handling\nwindow.dispatchEvent(new CustomEvent('licenseExpired',{detail:{message:errorData.message,expired_at_runtime:true}}));return;}}const data=await response.json();if(data.status==='success'){setLicenseInfo(data.license);setError(null);// Check if license expired during runtime\nif(data.license&&!data.license.is_valid&&data.license.expired_at_runtime){window.dispatchEvent(new CustomEvent('licenseExpired',{detail:{message:data.license.message,expired_at_runtime:true}}));}}else{setError(data.message||'Failed to get license status');}}catch(err){setError('Network error: Could not check license status');console.error('License status fetch error:',err);}finally{setLoading(false);}};useEffect(()=>{fetchLicenseStatus();// Check license status every hour\nconst interval=setInterval(fetchLicenseStatus,60*60*1000);return()=>clearInterval(interval);},[]);const getLicenseStatusClass=()=>{if(!licenseInfo||!licenseInfo.is_valid)return'license-status-error';if(licenseInfo.days_remaining<=3)return'license-status-critical';if(licenseInfo.days_remaining<=7)return'license-status-warning';return'license-status-ok';};const getLicenseIcon=()=>{if(!licenseInfo||!licenseInfo.is_valid)return'‚ùå';if(licenseInfo.days_remaining<=3)return'üö®';if(licenseInfo.days_remaining<=7)return'‚ö†Ô∏è';return'‚úÖ';};const formatExpiryDate=()=>{var _licenseInfo$license_;if(!(licenseInfo!==null&&licenseInfo!==void 0&&(_licenseInfo$license_=licenseInfo.license_info)!==null&&_licenseInfo$license_!==void 0&&_licenseInfo$license_.expiry_date))return'Unknown';try{const expiryDate=new Date(licenseInfo.license_info.expiry_date);return expiryDate.toLocaleDateString();}catch(err){return'Invalid date';}};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"license-status license-status-loading\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"license-icon\",children:\"\\u23F3\"}),/*#__PURE__*/_jsx(\"span\",{className:\"license-text\",children:\"Checking license...\"})]});}if(error){return/*#__PURE__*/_jsxs(\"div\",{className:\"license-status license-status-error\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"license-icon\",children:\"\\u274C\"}),/*#__PURE__*/_jsx(\"span\",{className:\"license-text\",children:\"License Error\"}),/*#__PURE__*/_jsx(\"div\",{className:\"license-details\",children:/*#__PURE__*/_jsx(\"small\",{children:error})})]});}if(!licenseInfo){return null;}return/*#__PURE__*/_jsxs(\"div\",{className:`license-status ${getLicenseStatusClass()}`,children:[/*#__PURE__*/_jsx(\"span\",{className:\"license-icon\",children:getLicenseIcon()}),/*#__PURE__*/_jsxs(\"div\",{className:\"license-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"license-main\",children:[licenseInfo.is_beta&&/*#__PURE__*/_jsx(\"span\",{className:\"license-badge\",children:\"BETA\"}),/*#__PURE__*/_jsx(\"span\",{className:\"license-text\",children:licenseInfo.is_valid?`${licenseInfo.days_remaining} days remaining`:'License Expired'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"license-details\",children:/*#__PURE__*/_jsx(\"small\",{children:licenseInfo.is_valid?`Expires: ${formatExpiryDate()}`:licenseInfo.message})})]}),licenseInfo.days_remaining<=7&&licenseInfo.is_valid&&/*#__PURE__*/_jsx(\"div\",{className:\"license-warning\",children:/*#__PURE__*/_jsx(\"small\",{children:\"\\u26A0\\uFE0F Beta trial ending soon! Thank you for testing SELO DSP.\"})})]});};export default LicenseStatus;","map":{"version":3,"names":["React","useState","useEffect","getApiBaseUrl","jsx","_jsx","jsxs","_jsxs","LicenseStatus","licenseInfo","setLicenseInfo","loading","setLoading","error","setError","fetchLicenseStatus","apiBase","response","fetch","status","errorData","json","is_valid","message","days_remaining","is_beta","expired_at_runtime","window","dispatchEvent","CustomEvent","detail","data","license","err","console","interval","setInterval","clearInterval","getLicenseStatusClass","getLicenseIcon","formatExpiryDate","_licenseInfo$license_","license_info","expiry_date","expiryDate","Date","toLocaleDateString","className","children"],"sources":["/mnt/local/Projects/SELODSP1/selo-ai/frontend/src/components/LicenseStatus.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport './LicenseStatus.css';\nimport { getApiBaseUrl } from '../services/config';\n\nconst LicenseStatus = () => {\n  const [licenseInfo, setLicenseInfo] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  const fetchLicenseStatus = async () => {\n    try {\n      setLoading(true);\n      const apiBase = await getApiBaseUrl();\n      const response = await fetch(`${apiBase}/license/status`);\n      \n      // Check if we got a license expired response\n      if (response.status === 403) {\n        const errorData = await response.json();\n        if (errorData.error === 'license_expired') {\n          setLicenseInfo({\n            is_valid: false,\n            message: errorData.message,\n            days_remaining: 0,\n            is_beta: true,\n            expired_at_runtime: true\n          });\n          setError(null);\n          \n          // Trigger app-wide license expiry handling\n          window.dispatchEvent(new CustomEvent('licenseExpired', {\n            detail: { message: errorData.message, expired_at_runtime: true }\n          }));\n          \n          return;\n        }\n      }\n      \n      const data = await response.json();\n      \n      if (data.status === 'success') {\n        setLicenseInfo(data.license);\n        setError(null);\n        \n        // Check if license expired during runtime\n        if (data.license && !data.license.is_valid && data.license.expired_at_runtime) {\n          window.dispatchEvent(new CustomEvent('licenseExpired', {\n            detail: { message: data.license.message, expired_at_runtime: true }\n          }));\n        }\n      } else {\n        setError(data.message || 'Failed to get license status');\n      }\n    } catch (err) {\n      setError('Network error: Could not check license status');\n      console.error('License status fetch error:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchLicenseStatus();\n    \n    // Check license status every hour\n    const interval = setInterval(fetchLicenseStatus, 60 * 60 * 1000);\n    \n    return () => clearInterval(interval);\n  }, []);\n\n  const getLicenseStatusClass = () => {\n    if (!licenseInfo || !licenseInfo.is_valid) return 'license-status-error';\n    if (licenseInfo.days_remaining <= 3) return 'license-status-critical';\n    if (licenseInfo.days_remaining <= 7) return 'license-status-warning';\n    return 'license-status-ok';\n  };\n\n  const getLicenseIcon = () => {\n    if (!licenseInfo || !licenseInfo.is_valid) return '‚ùå';\n    if (licenseInfo.days_remaining <= 3) return 'üö®';\n    if (licenseInfo.days_remaining <= 7) return '‚ö†Ô∏è';\n    return '‚úÖ';\n  };\n\n  const formatExpiryDate = () => {\n    if (!licenseInfo?.license_info?.expiry_date) return 'Unknown';\n    \n    try {\n      const expiryDate = new Date(licenseInfo.license_info.expiry_date);\n      return expiryDate.toLocaleDateString();\n    } catch (err) {\n      return 'Invalid date';\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"license-status license-status-loading\">\n        <span className=\"license-icon\">‚è≥</span>\n        <span className=\"license-text\">Checking license...</span>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"license-status license-status-error\">\n        <span className=\"license-icon\">‚ùå</span>\n        <span className=\"license-text\">License Error</span>\n        <div className=\"license-details\">\n          <small>{error}</small>\n        </div>\n      </div>\n    );\n  }\n\n  if (!licenseInfo) {\n    return null;\n  }\n\n  return (\n    <div className={`license-status ${getLicenseStatusClass()}`}>\n      <span className=\"license-icon\">{getLicenseIcon()}</span>\n      <div className=\"license-content\">\n        <div className=\"license-main\">\n          {licenseInfo.is_beta && (\n            <span className=\"license-badge\">BETA</span>\n          )}\n          <span className=\"license-text\">\n            {licenseInfo.is_valid \n              ? `${licenseInfo.days_remaining} days remaining`\n              : 'License Expired'\n            }\n          </span>\n        </div>\n        <div className=\"license-details\">\n          <small>\n            {licenseInfo.is_valid \n              ? `Expires: ${formatExpiryDate()}`\n              : licenseInfo.message\n            }\n          </small>\n        </div>\n      </div>\n      {licenseInfo.days_remaining <= 7 && licenseInfo.is_valid && (\n        <div className=\"license-warning\">\n          <small>\n            ‚ö†Ô∏è Beta trial ending soon! Thank you for testing SELO DSP.\n          </small>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default LicenseStatus;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}