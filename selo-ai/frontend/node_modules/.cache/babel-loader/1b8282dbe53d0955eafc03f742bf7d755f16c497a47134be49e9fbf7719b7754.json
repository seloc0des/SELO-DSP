{"ast":null,"code":"import React,{useState,useEffect}from'react';import personaService from'../../services/personaService';/**\n * ReflectionCard displays an individual reflection with expandable content\n */import{jsxs as _jsxs,jsx as _jsx,Fragment as _Fragment}from\"react/jsx-runtime\";const ReflectionCard=_ref=>{var _emotional_state$seco;let{reflection,timeAgo}=_ref;const reflectionId=(reflection===null||reflection===void 0?void 0:reflection.id)||(reflection===null||reflection===void 0?void 0:reflection.reflection_id);// Load expanded state from localStorage\nconst getExpandedState=()=>{try{if(!reflectionId)return false;const key=`reflection_expanded_${reflectionId}`;const stored=localStorage.getItem(key);return stored==='true';}catch(e){return false;}};const[expanded,setExpanded]=useState(getExpandedState);// State for traits\nconst[topTraits,setTopTraits]=useState([]);const[loadingTraits,setLoadingTraits]=useState(false);// Persist expanded state to localStorage\nuseEffect(()=>{if(reflectionId){try{const key=`reflection_expanded_${reflectionId}`;localStorage.setItem(key,expanded.toString());}catch(e){console.warn('Failed to save expanded state:',e);}}},[expanded,reflectionId]);// Fetch traits when component mounts\nuseEffect(()=>{let mounted=true;const fetchTraits=async()=>{try{setLoadingTraits(true);// Fetch default persona traits\nconst resp=await personaService.getDefaultPersonaTraits();if(!mounted)return;// Normalize to { name, value, category }\nconst traits=Array.isArray(resp===null||resp===void 0?void 0:resp.traits)?resp.traits:[];const normalized=traits.map(t=>({name:(t===null||t===void 0?void 0:t.name)||(t===null||t===void 0?void 0:t.trait)||(t===null||t===void 0?void 0:t.id)||'',value:typeof(t===null||t===void 0?void 0:t.value)==='number'?t.value:typeof(t===null||t===void 0?void 0:t.weight)==='number'?t.weight:null,category:(t===null||t===void 0?void 0:t.category)||''})).filter(t=>t.name&&t.value!==null).sort((a,b)=>b.value-a.value).slice(0,6);if(mounted)setTopTraits(normalized);}catch(e){if(mounted)setTopTraits([]);}finally{if(mounted)setLoadingTraits(false);}};fetchTraits();return()=>{mounted=false;};},[]);// Normalize result structure (support string, object, or missing)\nlet parsedResult={};try{if(typeof(reflection===null||reflection===void 0?void 0:reflection.result)==='string'){parsedResult=JSON.parse(reflection.result);}else if(typeof(reflection===null||reflection===void 0?void 0:reflection.result)==='object'&&(reflection===null||reflection===void 0?void 0:reflection.result)!==null){parsedResult=reflection.result;}else{parsedResult={};}}catch(e){parsedResult={};}// Safely extract fields with sensible fallbacks\nconst content=parsedResult.content||reflection.content||'';const themes=parsedResult.themes||[];const insights=parsedResult.insights||[];const actions=parsedResult.actions||[];const emotional_state=parsedResult.emotional_state||{};return/*#__PURE__*/_jsxs(\"div\",{className:\"border border-[var(--color-border)] bg-[var(--color-bg-elev-1)] rounded-lg overflow-hidden transition-all\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"text-lg font-medium text-[var(--color-accent)]\",children:[(reflection.reflection_type||reflection.type||'reflection').toString().replace(/^(.)/,(m,c)=>c.toUpperCase()),\" Reflection\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-400\",children:timeAgo})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setExpanded(!expanded),className:\"text-[var(--color-accent-strong)] hover:opacity-90 transition-colors\",\"aria-expanded\":expanded,children:[/*#__PURE__*/_jsx(\"span\",{className:\"sr-only\",children:expanded?'Collapse':'Expand'}),/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:`h-5 w-5 transition-transform ${expanded?'rotate-180':''}`,viewBox:\"0 0 20 20\",fill:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z\",clipRule:\"evenodd\"})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"px-4 pb-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:themes.map((theme,i)=>/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 text-xs rounded-full bg-[color:var(--color-accent)/0.08] text-[var(--color-accent)] border border-[var(--color-border)]\",children:theme},i))})}),expanded&&/*#__PURE__*/_jsx(\"div\",{className:\"p-4 border-t border-[var(--color-border)] mt-2 bg-[var(--color-bg-elev-1)]\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"prose prose-sm prose-invert max-w-none whitespace-pre-wrap\",children:content}),topTraits.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 p-3 rounded-md bg-[var(--color-bg-elev-2)] border border-[var(--color-border)]\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"text-sm font-medium text-[var(--color-accent-strong)] mb-2\",children:\"\\uD83C\\uDFF7\\uFE0F Current Traits\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:topTraits.map((t,i)=>/*#__PURE__*/_jsxs(\"span\",{title:t.category?`${t.name} ‚Ä¢ ${t.category}`:t.name,className:\"px-2 py-0.5 text-[10px] rounded-full bg-[var(--color-bg-elev-2)] text-[var(--color-text-secondary)] border border-[var(--color-border)]\",children:[t.name,typeof t.value==='number'&&/*#__PURE__*/_jsxs(_Fragment,{children:[\" \",/*#__PURE__*/_jsx(\"span\",{className:\"text-[var(--color-accent)]\",children:t.value.toFixed(2)})]})]},`${t.name}-${i}`))})]}),emotional_state&&Object.keys(emotional_state).length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 p-3 rounded-md bg-[var(--color-bg-elev-2)] border border-[var(--color-border)]\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"text-sm font-medium text-[var(--color-accent-strong)] mb-2\",children:\"Emotional State\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-2 text-xs\",children:[emotional_state.primary&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-[var(--color-text-muted)]\",children:\"Primary:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{className:\"text-[var(--color-text-primary)]\",children:emotional_state.primary})]}),emotional_state.intensity!==undefined&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-[var(--color-text-muted)]\",children:\"Intensity:\"}),\" \",/*#__PURE__*/_jsxs(\"span\",{className:\"text-[var(--color-text-primary)]\",children:[(emotional_state.intensity*100).toFixed(0),\"%\"]})]}),((_emotional_state$seco=emotional_state.secondary)===null||_emotional_state$seco===void 0?void 0:_emotional_state$seco.length)>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"col-span-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-[var(--color-text-muted)]\",children:\"Secondary:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{className:\"text-[var(--color-text-primary)]\",children:emotional_state.secondary.join(', ')})]}),emotional_state.trend&&/*#__PURE__*/_jsxs(\"div\",{className:\"col-span-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-[var(--color-text-muted)]\",children:\"Trend:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{className:\"text-[var(--color-text-primary)]\",children:emotional_state.trend})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4\",children:[insights.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 rounded-md bg-[var(--color-bg-elev-2)] border border-[var(--color-border)]\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"text-sm font-medium text-[var(--color-accent)] mb-2\",children:\"Key Insights\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"list-disc list-inside text-xs space-y-1 text-[var(--color-text-secondary)]\",children:insights.map((insight,i)=>/*#__PURE__*/_jsx(\"li\",{children:insight},i))})]}),actions.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 rounded-md bg-[var(--color-bg-elev-2)] border border-[var(--color-border)]\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"text-sm font-medium text-[var(--color-accent-strong)] mb-2\",children:\"Suggested Actions\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"list-disc list-inside text-xs space-y-1 text-[var(--color-text-secondary)]\",children:actions.map((action,i)=>/*#__PURE__*/_jsx(\"li\",{children:action},i))})]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 bg-[var(--color-bg-elev-1)] border-t border-[var(--color-border)] flex justify-between items-center\",children:[reflection.id&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-[var(--color-text-muted)]\",children:[\"ID: \",reflection.id.substring(0,8)]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setExpanded(!expanded),className:\"text-xs text-[var(--color-accent)] hover:opacity-90 transition-colors\",children:expanded?'Show Less':'Show More'})]})]});};export default ReflectionCard;","map":{"version":3,"names":["React","useState","useEffect","personaService","jsxs","_jsxs","jsx","_jsx","Fragment","_Fragment","ReflectionCard","_ref","_emotional_state$seco","reflection","timeAgo","reflectionId","id","reflection_id","getExpandedState","key","stored","localStorage","getItem","e","expanded","setExpanded","topTraits","setTopTraits","loadingTraits","setLoadingTraits","setItem","toString","console","warn","mounted","fetchTraits","resp","getDefaultPersonaTraits","traits","Array","isArray","normalized","map","t","name","trait","value","weight","category","filter","sort","a","b","slice","parsedResult","result","JSON","parse","content","themes","insights","actions","emotional_state","className","children","reflection_type","type","replace","m","c","toUpperCase","onClick","xmlns","viewBox","fill","fillRule","d","clipRule","theme","i","length","title","toFixed","Object","keys","primary","intensity","undefined","secondary","join","trend","insight","action","substring"],"sources":["/mnt/local/Projects/SELODSP1/selo-ai/frontend/src/components/Reflection/ReflectionCard.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport personaService from '../../services/personaService';\n\n/**\n * ReflectionCard displays an individual reflection with expandable content\n */\nconst ReflectionCard = ({ reflection, timeAgo }) => {\n  const reflectionId = reflection?.id || reflection?.reflection_id;\n  \n  // Load expanded state from localStorage\n  const getExpandedState = () => {\n    try {\n      if (!reflectionId) return false;\n      const key = `reflection_expanded_${reflectionId}`;\n      const stored = localStorage.getItem(key);\n      return stored === 'true';\n    } catch (e) {\n      return false;\n    }\n  };\n\n  const [expanded, setExpanded] = useState(getExpandedState);\n  // State for traits\n  const [topTraits, setTopTraits] = useState([]);\n  const [loadingTraits, setLoadingTraits] = useState(false);\n\n  // Persist expanded state to localStorage\n  useEffect(() => {\n    if (reflectionId) {\n      try {\n        const key = `reflection_expanded_${reflectionId}`;\n        localStorage.setItem(key, expanded.toString());\n      } catch (e) {\n        console.warn('Failed to save expanded state:', e);\n      }\n    }\n  }, [expanded, reflectionId]);\n\n  // Fetch traits when component mounts\n  useEffect(() => {\n    let mounted = true;\n    \n    const fetchTraits = async () => {\n      try {\n        setLoadingTraits(true);\n        // Fetch default persona traits\n        const resp = await personaService.getDefaultPersonaTraits();\n        if (!mounted) return;\n        \n        // Normalize to { name, value, category }\n        const traits = Array.isArray(resp?.traits) ? resp.traits : [];\n        const normalized = traits\n          .map(t => ({\n            name: t?.name || t?.trait || t?.id || '',\n            value: typeof t?.value === 'number' ? t.value : \n                   (typeof t?.weight === 'number' ? t.weight : null),\n            category: t?.category || '',\n          }))\n          .filter(t => t.name && t.value !== null)\n          .sort((a, b) => (b.value - a.value))\n          .slice(0, 6);\n          \n        if (mounted) setTopTraits(normalized);\n      } catch (e) {\n        if (mounted) setTopTraits([]);\n      } finally {\n        if (mounted) setLoadingTraits(false);\n      }\n    };\n    \n    fetchTraits();\n    return () => { mounted = false; };\n  }, []);\n\n  // Normalize result structure (support string, object, or missing)\n  let parsedResult = {};\n  try {\n    if (typeof reflection?.result === 'string') {\n      parsedResult = JSON.parse(reflection.result);\n    } else if (typeof reflection?.result === 'object' && reflection?.result !== null) {\n      parsedResult = reflection.result;\n    } else {\n      parsedResult = {};\n    }\n  } catch (e) {\n    parsedResult = {};\n  }\n\n  // Safely extract fields with sensible fallbacks\n  const content = parsedResult.content || reflection.content || '';\n  const themes = parsedResult.themes || [];\n  const insights = parsedResult.insights || [];\n  const actions = parsedResult.actions || [];\n  const emotional_state = parsedResult.emotional_state || {};\n  \n  return (\n    <div className=\"border border-[var(--color-border)] bg-[var(--color-bg-elev-1)] rounded-lg overflow-hidden transition-all\">\n      {/* Card Header */}\n      <div className=\"p-4 flex justify-between items-center\">\n        <div>\n          <h4 className=\"text-lg font-medium text-[var(--color-accent)]\">\n            {(reflection.reflection_type || reflection.type || 'reflection')\n              .toString()\n              .replace(/^(.)/, (m, c) => c.toUpperCase())} Reflection\n          </h4>\n          <p className=\"text-xs text-gray-400\">{timeAgo}</p>\n        </div>\n        \n        <button \n          onClick={() => setExpanded(!expanded)} \n          className=\"text-[var(--color-accent-strong)] hover:opacity-90 transition-colors\"\n          aria-expanded={expanded}\n        >\n          <span className=\"sr-only\">{expanded ? 'Collapse' : 'Expand'}</span>\n          <svg \n            xmlns=\"http://www.w3.org/2000/svg\" \n            className={`h-5 w-5 transition-transform ${expanded ? 'rotate-180' : ''}`}\n            viewBox=\"0 0 20 20\" \n            fill=\"currentColor\"\n          >\n            <path \n              fillRule=\"evenodd\" \n              d=\"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z\" \n              clipRule=\"evenodd\" \n            />\n          </svg>\n        </button>\n      </div>\n      \n      {/* Preview (always visible) */}\n      <div className=\"px-4 pb-2\">\n        <div className=\"flex flex-wrap gap-2\">\n          {themes.map((theme, i) => (\n            <span \n              key={i} \n              className=\"px-2 py-1 text-xs rounded-full bg-[color:var(--color-accent)/0.08] text-[var(--color-accent)] border border-[var(--color-border)]\"\n            >\n              {theme}\n            </span>\n          ))}\n        </div>\n      </div>\n      \n      {/* Expanded content */}\n      {expanded && (\n        <div className=\"p-4 border-t border-[var(--color-border)] mt-2 bg-[var(--color-bg-elev-1)]\">\n          {/* Main reflection content */}\n          <div className=\"space-y-4\">\n            <div className=\"prose prose-sm prose-invert max-w-none whitespace-pre-wrap\">{content}</div>\n            \n            {/* Current Traits (moved from preview to expanded section) */}\n            {topTraits.length > 0 && (\n              <div className=\"mt-4 p-3 rounded-md bg-[var(--color-bg-elev-2)] border border-[var(--color-border)]\">\n                <h5 className=\"text-sm font-medium text-[var(--color-accent-strong)] mb-2\">üè∑Ô∏è Current Traits</h5>\n                <div className=\"flex flex-wrap gap-2\">\n                  {topTraits.map((t, i) => (\n                    <span\n                      key={`${t.name}-${i}`}\n                      title={t.category ? `${t.name} ‚Ä¢ ${t.category}` : t.name}\n                      className=\"px-2 py-0.5 text-[10px] rounded-full bg-[var(--color-bg-elev-2)] text-[var(--color-text-secondary)] border border-[var(--color-border)]\"\n                    >\n                      {t.name}\n                      {typeof t.value === 'number' && (\n                        <>\n                          {\" \"}\n                          <span className=\"text-[var(--color-accent)]\">{(t.value).toFixed(2)}</span>\n                        </>\n                      )}\n                    </span>\n                  ))}\n                </div>\n              </div>\n            )}\n            \n            {/* Emotional state */}\n            {emotional_state && Object.keys(emotional_state).length > 0 && (\n              <div className=\"mt-4 p-3 rounded-md bg-[var(--color-bg-elev-2)] border border-[var(--color-border)]\">\n                <h5 className=\"text-sm font-medium text-[var(--color-accent-strong)] mb-2\">Emotional State</h5>\n                <div className=\"grid grid-cols-2 gap-2 text-xs\">\n                  {emotional_state.primary && (\n                    <div>\n                      <span className=\"text-[var(--color-text-muted)]\">Primary:</span>{\" \"}\n                      <span className=\"text-[var(--color-text-primary)]\">{emotional_state.primary}</span>\n                    </div>\n                  )}\n                  {emotional_state.intensity !== undefined && (\n                    <div>\n                      <span className=\"text-[var(--color-text-muted)]\">Intensity:</span>{\" \"}\n                      <span className=\"text-[var(--color-text-primary)]\">{(emotional_state.intensity * 100).toFixed(0)}%</span>\n                    </div>\n                  )}\n                  {emotional_state.secondary?.length > 0 && (\n                    <div className=\"col-span-2\">\n                      <span className=\"text-[var(--color-text-muted)]\">Secondary:</span>{\" \"}\n                      <span className=\"text-[var(--color-text-primary)]\">{emotional_state.secondary.join(', ')}</span>\n                    </div>\n                  )}\n                  {emotional_state.trend && (\n                    <div className=\"col-span-2\">\n                      <span className=\"text-[var(--color-text-muted)]\">Trend:</span>{\" \"}\n                      <span className=\"text-[var(--color-text-primary)]\">{emotional_state.trend}</span>\n                    </div>\n                  )}\n                </div>\n              </div>\n            )}\n            \n            {/* Insights and Actions */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4\">\n              {insights.length > 0 && (\n                <div className=\"p-3 rounded-md bg-[var(--color-bg-elev-2)] border border-[var(--color-border)]\">\n                  <h5 className=\"text-sm font-medium text-[var(--color-accent)] mb-2\">Key Insights</h5>\n                  <ul className=\"list-disc list-inside text-xs space-y-1 text-[var(--color-text-secondary)]\">\n                    {insights.map((insight, i) => (\n                      <li key={i}>{insight}</li>\n                    ))}\n                  </ul>\n                </div>\n              )}\n              \n              {actions.length > 0 && (\n                <div className=\"p-3 rounded-md bg-[var(--color-bg-elev-2)] border border-[var(--color-border)]\">\n                  <h5 className=\"text-sm font-medium text-[var(--color-accent-strong)] mb-2\">Suggested Actions</h5>\n                  <ul className=\"list-disc list-inside text-xs space-y-1 text-[var(--color-text-secondary)]\">\n                    {actions.map((action, i) => (\n                      <li key={i}>{action}</li>\n                    ))}\n                  </ul>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n      \n      {/* Card Footer */}\n      <div className=\"p-3 bg-[var(--color-bg-elev-1)] border-t border-[var(--color-border)] flex justify-between items-center\">\n        {reflection.id && (\n          <span className=\"text-xs text-[var(--color-text-muted)]\">\n            ID: {reflection.id.substring(0, 8)}\n          </span>\n        )}\n        \n        <button \n          onClick={() => setExpanded(!expanded)} \n          className=\"text-xs text-[var(--color-accent)] hover:opacity-90 transition-colors\"\n        >\n          {expanded ? 'Show Less' : 'Show More'}\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default ReflectionCard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}