{"ast":null,"code":"import React,{useState,useEffect}from'react';import personaService from'../../services/personaService';import PersonaTraitRadar from'./PersonaTraitRadar';/**\n * Component for displaying a single persona card\n * Shows basic persona information and allows selection\n */import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PersonaCard=_ref=>{var _persona$data;let{persona,isSelected,onClick}=_ref;const[traits,setTraits]=useState([]);const[loading,setLoading]=useState(true);const[presentation,setPresentation]=useState({first_intro:'',first_thoughts:'',last_session_summary:''});const[loadingPresentation,setLoadingPresentation]=useState(false);useEffect(()=>{const fetchData=async()=>{if(!(persona!==null&&persona!==void 0&&persona.id))return;setLoading(true);try{var _defaultPersona$data,_defaultPersona$data$;// First get the current default persona to ensure we have the latest ID\nconst defaultPersona=await personaService.getDefaultPersona();if(!(defaultPersona!==null&&defaultPersona!==void 0&&defaultPersona.success)||!((_defaultPersona$data=defaultPersona.data)!==null&&_defaultPersona$data!==void 0&&(_defaultPersona$data$=_defaultPersona$data.persona)!==null&&_defaultPersona$data$!==void 0&&_defaultPersona$data$.id)){throw new Error('Could not fetch default persona');}// Get traits for the current default persona\nconst traitsResponse=await personaService.getPersonaTraits(defaultPersona.data.persona.user_id,defaultPersona.data.persona.id);const traitsArr=traitsResponse&&Array.isArray(traitsResponse.traits)?traitsResponse.traits:[];setTraits(traitsArr);// Fetch persona presentation\nsetLoadingPresentation(true);const presentationResp=await personaService.getPersonaPresentation(defaultPersona.data.persona.user_id,defaultPersona.data.persona.id);const payload=presentationResp!==null&&presentationResp!==void 0&&presentationResp.data?presentationResp.data:{};setPresentation({first_intro:typeof payload.first_intro==='string'?payload.first_intro:'',first_thoughts:typeof payload.first_thoughts==='string'?payload.first_thoughts:'',last_session_summary:typeof payload.last_session_summary==='string'?payload.last_session_summary:''});}catch(error){console.error('Error in PersonaCard data fetch:',error);setTraits([]);setPresentation({first_intro:'',first_thoughts:'',last_session_summary:''});}finally{setLoading(false);setLoadingPresentation(false);}};if(persona!==null&&persona!==void 0&&persona.id){fetchData();}},[persona]);// Format date for display\nconst formatDate=dateString=>{if(!dateString)return'Unknown';const date=new Date(dateString);return date.toLocaleString('en-US',{year:'numeric',month:'short',day:'numeric',hour:'2-digit',minute:'2-digit'});};// Traits are visualized via PersonaTraitRadar below\n// Color styling based on selection state (modern dark theme)\nconst cardClasses=isSelected?'border-[var(--color-accent)] bg-[var(--color-bg-elev-2)]':'border-[var(--color-border)] bg-[var(--color-bg-elev-1)] hover:bg-[var(--color-bg-elev-2)]';return/*#__PURE__*/_jsxs(\"div\",{className:`rounded-md border p-4 cursor-pointer transition-all ${cardClasses}`,onClick:onClick,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-2\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-lg font-medium text-[var(--color-text-primary)]\",children:(persona===null||persona===void 0?void 0:persona.name)||(persona===null||persona===void 0?void 0:(_persona$data=persona.data)===null||_persona$data===void 0?void 0:_persona$data.name)||'SELO'}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs px-2 py-1 rounded bg-[var(--color-bg-elev-2)] text-[var(--color-text-secondary)] border border-[var(--color-border)]\",children:[\"v\",persona.version||'1.0']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-2\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-[var(--color-text-muted)] uppercase tracking-wide\",children:\"First Thoughts\"})}),loadingPresentation?/*#__PURE__*/_jsx(\"div\",{className:\"h-10 animate-pulse bg-[var(--color-bg-elev-2)] rounded\"}):/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-[var(--color-text-secondary)] italic whitespace-pre-wrap\",children:presentation.first_thoughts||presentation.first_intro||persona.boot_directive||persona.description||'No first thoughts available'})]}),loading?/*#__PURE__*/_jsx(\"div\",{className:\"h-10 animate-pulse bg-[var(--color-bg-elev-2)] rounded\"}):/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:/*#__PURE__*/_jsx(PersonaTraitRadar,{traits:traits})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 text-xs text-[var(--color-text-muted)]\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"Created: \",formatDate(persona.creation_date)]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Last evolved: \",formatDate(persona.last_modified)]})]})]});};export default PersonaCard;","map":{"version":3,"names":["React","useState","useEffect","personaService","PersonaTraitRadar","jsx","_jsx","jsxs","_jsxs","PersonaCard","_ref","_persona$data","persona","isSelected","onClick","traits","setTraits","loading","setLoading","presentation","setPresentation","first_intro","first_thoughts","last_session_summary","loadingPresentation","setLoadingPresentation","fetchData","id","_defaultPersona$data","_defaultPersona$data$","defaultPersona","getDefaultPersona","success","data","Error","traitsResponse","getPersonaTraits","user_id","traitsArr","Array","isArray","presentationResp","getPersonaPresentation","payload","error","console","formatDate","dateString","date","Date","toLocaleString","year","month","day","hour","minute","cardClasses","className","children","name","version","boot_directive","description","creation_date","last_modified"],"sources":["/mnt/local/Projects/SELODSP1/selo-ai/frontend/src/components/Persona/PersonaCard.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport personaService from '../../services/personaService';\nimport PersonaTraitRadar from './PersonaTraitRadar';\n\n/**\n * Component for displaying a single persona card\n * Shows basic persona information and allows selection\n */\nconst PersonaCard = ({ persona, isSelected, onClick }) => {\n  const [traits, setTraits] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [presentation, setPresentation] = useState({ first_intro: '', first_thoughts: '', last_session_summary: '' });\n  const [loadingPresentation, setLoadingPresentation] = useState(false);\n  \n  useEffect(() => {\n    const fetchData = async () => {\n      if (!persona?.id) return;\n      \n      setLoading(true);\n      try {\n        // First get the current default persona to ensure we have the latest ID\n        const defaultPersona = await personaService.getDefaultPersona();\n        if (!defaultPersona?.success || !defaultPersona.data?.persona?.id) {\n          throw new Error('Could not fetch default persona');\n        }\n        \n        // Get traits for the current default persona\n        const traitsResponse = await personaService.getPersonaTraits(\n          defaultPersona.data.persona.user_id, \n          defaultPersona.data.persona.id\n        );\n        const traitsArr = (traitsResponse && Array.isArray(traitsResponse.traits)) \n          ? traitsResponse.traits \n          : [];\n        setTraits(traitsArr);\n        \n        // Fetch persona presentation\n        setLoadingPresentation(true);\n        const presentationResp = await personaService.getPersonaPresentation(\n          defaultPersona.data.persona.user_id, \n          defaultPersona.data.persona.id\n        );\n        \n        const payload = (presentationResp?.data) \n          ? presentationResp.data \n          : {};\n          \n        setPresentation({\n          first_intro: typeof payload.first_intro === 'string' ? payload.first_intro : '',\n          first_thoughts: typeof payload.first_thoughts === 'string' ? payload.first_thoughts : '',\n          last_session_summary: typeof payload.last_session_summary === 'string' \n            ? payload.last_session_summary \n            : '',\n        });\n      } catch (error) {\n        console.error('Error in PersonaCard data fetch:', error);\n        setTraits([]);\n        setPresentation({ first_intro: '', first_thoughts: '', last_session_summary: '' });\n      } finally {\n        setLoading(false);\n        setLoadingPresentation(false);\n      }\n    };\n    \n    if (persona?.id) {\n      fetchData();\n    }\n  }, [persona]);\n  \n  // Format date for display\n  const formatDate = (dateString) => {\n    if (!dateString) return 'Unknown';\n    const date = new Date(dateString);\n    return date.toLocaleString('en-US', { \n      year: 'numeric', \n      month: 'short', \n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n  \n  // Traits are visualized via PersonaTraitRadar below\n    \n  // Color styling based on selection state (modern dark theme)\n  const cardClasses = isSelected \n    ? 'border-[var(--color-accent)] bg-[var(--color-bg-elev-2)]'\n    : 'border-[var(--color-border)] bg-[var(--color-bg-elev-1)] hover:bg-[var(--color-bg-elev-2)]';\n  \n  return (\n    <div \n      className={`rounded-md border p-4 cursor-pointer transition-all ${cardClasses}`}\n      onClick={onClick}\n    >\n      <div className=\"flex justify-between items-start mb-2\">\n        <h4 className=\"text-lg font-medium text-[var(--color-text-primary)]\">\n          {persona?.name || persona?.data?.name || 'SELO'}\n        </h4>\n        <span className=\"text-xs px-2 py-1 rounded bg-[var(--color-bg-elev-2)] text-[var(--color-text-secondary)] border border-[var(--color-border)]\">\n          v{persona.version || '1.0'}\n        </span>\n      </div>\n      \n      <div className=\"mb-3\">\n        <div className=\"mb-2\">\n          <span className=\"text-xs text-[var(--color-text-muted)] uppercase tracking-wide\">First Thoughts</span>\n        </div>\n        {loadingPresentation ? (\n          <div className=\"h-10 animate-pulse bg-[var(--color-bg-elev-2)] rounded\" />\n        ) : (\n          <p className=\"text-sm text-[var(--color-text-secondary)] italic whitespace-pre-wrap\">\n            {presentation.first_thoughts \n              || presentation.first_intro \n              || persona.boot_directive \n              || persona.description \n              || 'No first thoughts available'}\n          </p>\n        )}\n      </div>\n      \n      {loading ? (\n        <div className=\"h-10 animate-pulse bg-[var(--color-bg-elev-2)] rounded\"></div>\n      ) : (\n        <div className=\"mb-3\">\n          {/* Read-only radar visualization of traits (no controls) */}\n          <PersonaTraitRadar traits={traits} />\n        </div>\n      )}\n      \n      <div className=\"mt-3 text-xs text-[var(--color-text-muted)]\">\n        <div>Created: {formatDate(persona.creation_date)}</div>\n        <div>Last evolved: {formatDate(persona.last_modified)}</div>\n      </div>\n    </div>\n  );\n};\n\nexport default PersonaCard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}