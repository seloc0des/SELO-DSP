{"ast":null,"code":"import React,{useState,useEffect}from'react';import personaService from'../../services/personaService';import{jsxs as _jsxs,jsx as _jsx,Fragment as _Fragment}from\"react/jsx-runtime\";export const parseJsonFromString=value=>{if(typeof value!=='string')return null;let trimmed=value.trim();if(!trimmed)return null;const stripFence=str=>{const fenceStart=str.match(/^```(?:json)?/i);if(fenceStart){str=str.replace(/^```(?:json)?/i,'');}if(str.endsWith('```')){str=str.slice(0,-3);}return str.trim();};const sanitiseLooseJson=str=>{let candidate=stripFence(str);if(!candidate)return'';candidate=candidate.replace(/\"intensity\"\\s*:\\s*,/g,'\"intensity\": null,');candidate=candidate.replace(/,\\s*(?=[}\\]])/g,'');return candidate.trim();};const tryParse=str=>{if(!str)return null;try{return JSON.parse(str);}catch(e){return null;}};let candidate=sanitiseLooseJson(trimmed);let parsed=tryParse(candidate);if(parsed)return parsed;const firstBrace=candidate.indexOf('{');const lastBrace=candidate.lastIndexOf('}');if(firstBrace!==-1&&lastBrace!==-1&&lastBrace>firstBrace){parsed=tryParse(candidate.slice(firstBrace,lastBrace+1));if(parsed)return parsed;}return null;};export const sanitizeContentText=value=>{if(typeof value!=='string')return'';const trimmed=value.trim();if(!trimmed)return'';const parsed=parseJsonFromString(trimmed);if(parsed&&typeof parsed.content==='string'&&parsed.content.trim()){return parsed.content.trim();}const fenced=trimmed.match(/^```(?:json)?\\s*([\\s\\S]*?)\\s*```$/i);if(fenced){return fenced[1].trim();}return trimmed.replace(/^```(?:json)?/i,'').replace(/```$/i,'').trim();};export const toArray=value=>{if(Array.isArray(value)){return value.filter(item=>item!==null&&item!==undefined&&item!=='');}if(typeof value==='string'){const trimmed=value.trim();return trimmed?[trimmed]:[];}return[];};export const normalizeTraitChanges=value=>{if(!Array.isArray(value))return[];return value.filter(item=>item&&typeof item==='object');};const formatDisplayLabel=value=>{if(typeof value!=='string')return value;const cleaned=value.replace(/[_\\s]+/g,' ').trim();if(!cleaned)return'';return cleaned.replace(/\\b\\w/g,c=>c.toUpperCase());};/**\n * ReflectionCard displays an individual reflection with expandable content\n */const ReflectionCard=_ref=>{var _parsedResult$trait_c,_emotional_state$seco;let{reflection,timeAgo}=_ref;const reflectionId=(reflection===null||reflection===void 0?void 0:reflection.id)||(reflection===null||reflection===void 0?void 0:reflection.reflection_id);// Load expanded state from localStorage\nconst getExpandedState=()=>{try{if(!reflectionId)return false;const key=`reflection_expanded_${reflectionId}`;const stored=localStorage.getItem(key);return stored==='true';}catch(e){return false;}};const[expanded,setExpanded]=useState(getExpandedState);// State for traits\nconst[topTraits,setTopTraits]=useState([]);const[loadingTraits,setLoadingTraits]=useState(false);// Persist expanded state to localStorage\nuseEffect(()=>{if(reflectionId){try{const key=`reflection_expanded_${reflectionId}`;localStorage.setItem(key,expanded.toString());}catch(e){console.warn('Failed to save expanded state:',e);}}},[expanded,reflectionId]);// Fetch traits when component mounts\nuseEffect(()=>{let mounted=true;const fetchTraits=async()=>{try{setLoadingTraits(true);// Fetch default persona traits\nconst resp=await personaService.getDefaultPersonaTraits();if(!mounted)return;// Normalize to { name, value, category }\nconst traits=Array.isArray(resp===null||resp===void 0?void 0:resp.traits)?resp.traits:[];const normalized=traits.map(t=>({name:(t===null||t===void 0?void 0:t.name)||(t===null||t===void 0?void 0:t.trait)||(t===null||t===void 0?void 0:t.id)||'',value:typeof(t===null||t===void 0?void 0:t.value)==='number'?t.value:typeof(t===null||t===void 0?void 0:t.weight)==='number'?t.weight:null,category:(t===null||t===void 0?void 0:t.category)||''})).filter(t=>t.name&&t.value!==null).sort((a,b)=>b.value-a.value).slice(0,6);if(mounted)setTopTraits(normalized);}catch(e){if(mounted)setTopTraits([]);}finally{if(mounted)setLoadingTraits(false);}};fetchTraits();return()=>{mounted=false;};},[]);// Normalize result structure (support string, object, or missing)\nlet parsedResult={};try{if(typeof(reflection===null||reflection===void 0?void 0:reflection.result)==='string'){parsedResult=JSON.parse(reflection.result);}else if(typeof(reflection===null||reflection===void 0?void 0:reflection.result)==='object'&&(reflection===null||reflection===void 0?void 0:reflection.result)!==null){parsedResult=reflection.result;}else{parsedResult={};}}catch(e){parsedResult={};}const fallbackParsed=parseJsonFromString(reflection===null||reflection===void 0?void 0:reflection.content);if(fallbackParsed){parsedResult={...fallbackParsed,...parsedResult};}const pickList=function(){for(var _len=arguments.length,candidates=new Array(_len),_key=0;_key<_len;_key++){candidates[_key]=arguments[_key];}for(const candidate of candidates){const normalized=toArray(candidate);if(normalized.length>0){return normalized;}}return[];};const rawContent=parsedResult.content||reflection.content||'';const content=sanitizeContentText(rawContent);const themes=pickList(parsedResult.themes,reflection.themes);const insights=pickList(parsedResult.insights,reflection.insights);const actions=pickList(parsedResult.actions,reflection.actions);const trait_changes=normalizeTraitChanges((_parsedResult$trait_c=parsedResult.trait_changes)!==null&&_parsedResult$trait_c!==void 0?_parsedResult$trait_c:reflection.trait_changes);const baseEmotionalState={...(reflection!==null&&reflection!==void 0&&reflection.emotional_state&&typeof reflection.emotional_state==='object'?reflection.emotional_state:{}),...(parsedResult.emotional_state&&typeof parsedResult.emotional_state==='object'?parsedResult.emotional_state:{})};const secondary=toArray(baseEmotionalState.secondary);let intensity=baseEmotionalState.intensity;if(typeof intensity==='string'){const parsed=parseFloat(intensity);intensity=Number.isFinite(parsed)?parsed:undefined;}if(typeof intensity==='number'){intensity=Math.max(0,Math.min(1,intensity));}const emotional_state={...baseEmotionalState,...(typeof intensity==='number'?{intensity}:{}),...(secondary.length>0?{secondary}:{})};return/*#__PURE__*/_jsxs(\"div\",{className:\"border border-[var(--color-border)] bg-[var(--color-bg-elev-1)] rounded-lg overflow-hidden transition-all\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"text-lg font-medium text-[var(--color-accent)]\",children:[(reflection.reflection_type||reflection.type||'reflection').toString().replace(/^(.)/,(m,c)=>c.toUpperCase()),\" Reflection\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-400\",children:timeAgo})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setExpanded(!expanded),className:\"text-[var(--color-accent-strong)] hover:opacity-90 transition-colors\",\"aria-expanded\":expanded,children:[/*#__PURE__*/_jsx(\"span\",{className:\"sr-only\",children:expanded?'Collapse':'Expand'}),/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:`h-5 w-5 transition-transform ${expanded?'rotate-180':''}`,viewBox:\"0 0 20 20\",fill:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z\",clipRule:\"evenodd\"})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"px-4 pb-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:themes.map((theme,i)=>/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 text-xs rounded-full bg-[color:var(--color-accent)/0.08] text-[var(--color-accent)] border border-[var(--color-border)]\",children:formatDisplayLabel(theme)},i))})}),expanded&&/*#__PURE__*/_jsx(\"div\",{className:\"p-4 border-t border-[var(--color-border)] mt-2 bg-[var(--color-bg-elev-1)]\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"prose prose-sm prose-invert max-w-none whitespace-pre-wrap\",children:content}),trait_changes.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 p-3 rounded-md bg-[var(--color-bg-elev-2)] border border-[var(--color-border)]\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"text-sm font-medium text-[var(--color-accent-strong)] mb-2\",children:\"\\uD83D\\uDCCA Trait Changes\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-1\",children:trait_changes.map((change,i)=>{const traitName=formatDisplayLabel(change.trait||change.name||'Unknown');const delta=change.delta||change.change||0;const oldVal=change.old_value||change.from;const newVal=change.new_value||change.to;const isIncrease=delta>0;const isDecrease=delta<0;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between text-xs\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-[var(--color-text-secondary)]\",children:traitName}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[oldVal!==undefined&&newVal!==undefined&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-[var(--color-text-muted)]\",children:[typeof oldVal==='number'?oldVal.toFixed(2):oldVal,\" \\u2192 \",typeof newVal==='number'?newVal.toFixed(2):newVal]}),/*#__PURE__*/_jsxs(\"span\",{className:`font-medium ${isIncrease?'text-green-400':isDecrease?'text-red-400':'text-gray-400'}`,children:[isIncrease?'‚Üë':isDecrease?'‚Üì':'=',\" \",Math.abs(delta).toFixed(3)]})]})]},i);})})]}),topTraits.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 p-3 rounded-md bg-[var(--color-bg-elev-2)] border border-[var(--color-border)]\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"text-sm font-medium text-[var(--color-accent-strong)] mb-2\",children:\"\\uD83C\\uDFF7\\uFE0F Current Traits\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:topTraits.map((t,i)=>/*#__PURE__*/_jsxs(\"span\",{title:t.category?`${t.name} ‚Ä¢ ${t.category}`:t.name,className:\"px-2 py-0.5 text-[10px] rounded-full bg-[var(--color-bg-elev-2)] text-[var(--color-text-secondary)] border border-[var(--color-border)]\",children:[formatDisplayLabel(t.name),typeof t.value==='number'&&/*#__PURE__*/_jsxs(_Fragment,{children:[\" \",/*#__PURE__*/_jsx(\"span\",{className:\"text-[var(--color-accent)]\",children:t.value.toFixed(2)})]})]},`${t.name}-${i}`))})]}),emotional_state&&Object.keys(emotional_state).length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 p-3 rounded-md bg-[var(--color-bg-elev-2)] border border-[var(--color-border)]\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"text-sm font-medium text-[var(--color-accent-strong)] mb-2\",children:\"Emotional State\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-2 text-xs\",children:[emotional_state.primary&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-[var(--color-text-muted)]\",children:\"Primary:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{className:\"text-[var(--color-text-primary)]\",children:formatDisplayLabel(emotional_state.primary)})]}),emotional_state.intensity!==undefined&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-[var(--color-text-muted)]\",children:\"Intensity:\"}),\" \",/*#__PURE__*/_jsxs(\"span\",{className:\"text-[var(--color-text-primary)]\",children:[(emotional_state.intensity*100).toFixed(0),\"%\"]})]}),((_emotional_state$seco=emotional_state.secondary)===null||_emotional_state$seco===void 0?void 0:_emotional_state$seco.length)>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"col-span-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-[var(--color-text-muted)]\",children:\"Secondary:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{className:\"text-[var(--color-text-primary)]\",children:emotional_state.secondary.map(formatDisplayLabel).join(', ')})]}),emotional_state.trend&&/*#__PURE__*/_jsxs(\"div\",{className:\"col-span-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-[var(--color-text-muted)]\",children:\"Trend:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{className:\"text-[var(--color-text-primary)]\",children:formatDisplayLabel(emotional_state.trend)})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4\",children:[insights.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 rounded-md bg-[var(--color-bg-elev-2)] border border-[var(--color-border)]\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"text-sm font-medium text-[var(--color-accent)] mb-2\",children:\"Key Insights\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"list-disc list-inside text-xs space-y-1 text-[var(--color-text-secondary)]\",children:insights.map((insight,i)=>/*#__PURE__*/_jsx(\"li\",{children:insight},i))})]}),actions.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 rounded-md bg-[var(--color-bg-elev-2)] border border-[var(--color-border)]\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"text-sm font-medium text-[var(--color-accent-strong)] mb-2\",children:\"Suggested Actions\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"list-disc list-inside text-xs space-y-1 text-[var(--color-text-secondary)]\",children:actions.map((action,i)=>/*#__PURE__*/_jsx(\"li\",{children:action},i))})]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 bg-[var(--color-bg-elev-1)] border-t border-[var(--color-border)] flex justify-between items-center\",children:[reflection.id&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-[var(--color-text-muted)]\",children:[\"ID: \",reflection.id.substring(0,8)]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setExpanded(!expanded),className:\"text-xs text-[var(--color-accent)] hover:opacity-90 transition-colors\",children:expanded?'Show Less':'Show More'})]})]});};export default ReflectionCard;","map":{"version":3,"names":["React","useState","useEffect","personaService","jsxs","_jsxs","jsx","_jsx","Fragment","_Fragment","parseJsonFromString","value","trimmed","trim","stripFence","str","fenceStart","match","replace","endsWith","slice","sanitiseLooseJson","candidate","tryParse","JSON","parse","e","parsed","firstBrace","indexOf","lastBrace","lastIndexOf","sanitizeContentText","content","fenced","toArray","Array","isArray","filter","item","undefined","normalizeTraitChanges","formatDisplayLabel","cleaned","c","toUpperCase","ReflectionCard","_ref","_parsedResult$trait_c","_emotional_state$seco","reflection","timeAgo","reflectionId","id","reflection_id","getExpandedState","key","stored","localStorage","getItem","expanded","setExpanded","topTraits","setTopTraits","loadingTraits","setLoadingTraits","setItem","toString","console","warn","mounted","fetchTraits","resp","getDefaultPersonaTraits","traits","normalized","map","t","name","trait","weight","category","sort","a","b","parsedResult","result","fallbackParsed","pickList","_len","arguments","length","candidates","_key","rawContent","themes","insights","actions","trait_changes","baseEmotionalState","emotional_state","secondary","intensity","parseFloat","Number","isFinite","Math","max","min","className","children","reflection_type","type","m","onClick","xmlns","viewBox","fill","fillRule","d","clipRule","theme","i","change","traitName","delta","oldVal","old_value","from","newVal","new_value","to","isIncrease","isDecrease","toFixed","abs","title","Object","keys","primary","join","trend","insight","action","substring"],"sources":["/mnt/local/Projects/SELODSP1/selo-ai/frontend/src/components/Reflection/ReflectionCard.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport personaService from '../../services/personaService';\n\nexport const parseJsonFromString = (value) => {\n  if (typeof value !== 'string') return null;\n  let trimmed = value.trim();\n  if (!trimmed) return null;\n\n  const stripFence = (str) => {\n    const fenceStart = str.match(/^```(?:json)?/i);\n    if (fenceStart) {\n      str = str.replace(/^```(?:json)?/i, '');\n    }\n    if (str.endsWith('```')) {\n      str = str.slice(0, -3);\n    }\n    return str.trim();\n  };\n\n  const sanitiseLooseJson = (str) => {\n    let candidate = stripFence(str);\n    if (!candidate) return '';\n    candidate = candidate.replace(/\"intensity\"\\s*:\\s*,/g, '\"intensity\": null,');\n    candidate = candidate.replace(/,\\s*(?=[}\\]])/g, '');\n    return candidate.trim();\n  };\n\n  const tryParse = (str) => {\n    if (!str) return null;\n    try {\n      return JSON.parse(str);\n    } catch (e) {\n      return null;\n    }\n  };\n\n  let candidate = sanitiseLooseJson(trimmed);\n  let parsed = tryParse(candidate);\n  if (parsed) return parsed;\n\n  const firstBrace = candidate.indexOf('{');\n  const lastBrace = candidate.lastIndexOf('}');\n  if (firstBrace !== -1 && lastBrace !== -1 && lastBrace > firstBrace) {\n    parsed = tryParse(candidate.slice(firstBrace, lastBrace + 1));\n    if (parsed) return parsed;\n  }\n\n  return null;\n};\n\nexport const sanitizeContentText = (value) => {\n  if (typeof value !== 'string') return '';\n  const trimmed = value.trim();\n  if (!trimmed) return '';\n  const parsed = parseJsonFromString(trimmed);\n  if (parsed && typeof parsed.content === 'string' && parsed.content.trim()) {\n    return parsed.content.trim();\n  }\n  const fenced = trimmed.match(/^```(?:json)?\\s*([\\s\\S]*?)\\s*```$/i);\n  if (fenced) {\n    return fenced[1].trim();\n  }\n  return trimmed.replace(/^```(?:json)?/i, '').replace(/```$/i, '').trim();\n};\n\nexport const toArray = (value) => {\n  if (Array.isArray(value)) {\n    return value.filter((item) => item !== null && item !== undefined && item !== '');\n  }\n  if (typeof value === 'string') {\n    const trimmed = value.trim();\n    return trimmed ? [trimmed] : [];\n  }\n  return [];\n};\n\nexport const normalizeTraitChanges = (value) => {\n  if (!Array.isArray(value)) return [];\n  return value.filter((item) => item && typeof item === 'object');\n};\n\nconst formatDisplayLabel = (value) => {\n  if (typeof value !== 'string') return value;\n  const cleaned = value.replace(/[_\\s]+/g, ' ').trim();\n  if (!cleaned) return '';\n  return cleaned.replace(/\\b\\w/g, (c) => c.toUpperCase());\n};\n\n/**\n * ReflectionCard displays an individual reflection with expandable content\n */\nconst ReflectionCard = ({ reflection, timeAgo }) => {\n  const reflectionId = reflection?.id || reflection?.reflection_id;\n  \n  // Load expanded state from localStorage\n  const getExpandedState = () => {\n    try {\n      if (!reflectionId) return false;\n      const key = `reflection_expanded_${reflectionId}`;\n      const stored = localStorage.getItem(key);\n      return stored === 'true';\n    } catch (e) {\n      return false;\n    }\n  };\n\n  const [expanded, setExpanded] = useState(getExpandedState);\n  // State for traits\n  const [topTraits, setTopTraits] = useState([]);\n  const [loadingTraits, setLoadingTraits] = useState(false);\n\n  // Persist expanded state to localStorage\n  useEffect(() => {\n    if (reflectionId) {\n      try {\n        const key = `reflection_expanded_${reflectionId}`;\n        localStorage.setItem(key, expanded.toString());\n      } catch (e) {\n        console.warn('Failed to save expanded state:', e);\n      }\n    }\n  }, [expanded, reflectionId]);\n\n  // Fetch traits when component mounts\n  useEffect(() => {\n    let mounted = true;\n    \n    const fetchTraits = async () => {\n      try {\n        setLoadingTraits(true);\n        // Fetch default persona traits\n        const resp = await personaService.getDefaultPersonaTraits();\n        if (!mounted) return;\n        \n        // Normalize to { name, value, category }\n        const traits = Array.isArray(resp?.traits) ? resp.traits : [];\n        const normalized = traits\n          .map(t => ({\n            name: t?.name || t?.trait || t?.id || '',\n            value: typeof t?.value === 'number' ? t.value : \n                   (typeof t?.weight === 'number' ? t.weight : null),\n            category: t?.category || '',\n          }))\n          .filter(t => t.name && t.value !== null)\n          .sort((a, b) => (b.value - a.value))\n          .slice(0, 6);\n          \n        if (mounted) setTopTraits(normalized);\n      } catch (e) {\n        if (mounted) setTopTraits([]);\n      } finally {\n        if (mounted) setLoadingTraits(false);\n      }\n    };\n    \n    fetchTraits();\n    return () => { mounted = false; };\n  }, []);\n\n  // Normalize result structure (support string, object, or missing)\n  let parsedResult = {};\n  try {\n    if (typeof reflection?.result === 'string') {\n      parsedResult = JSON.parse(reflection.result);\n    } else if (typeof reflection?.result === 'object' && reflection?.result !== null) {\n      parsedResult = reflection.result;\n    } else {\n      parsedResult = {};\n    }\n  } catch (e) {\n    parsedResult = {};\n  }\n\n  const fallbackParsed = parseJsonFromString(reflection?.content);\n  if (fallbackParsed) {\n    parsedResult = { ...fallbackParsed, ...parsedResult };\n  }\n\n  const pickList = (...candidates) => {\n    for (const candidate of candidates) {\n      const normalized = toArray(candidate);\n      if (normalized.length > 0) {\n        return normalized;\n      }\n    }\n    return [];\n  };\n\n  const rawContent = parsedResult.content || reflection.content || '';\n  const content = sanitizeContentText(rawContent);\n  const themes = pickList(parsedResult.themes, reflection.themes);\n  const insights = pickList(parsedResult.insights, reflection.insights);\n  const actions = pickList(parsedResult.actions, reflection.actions);\n  const trait_changes = normalizeTraitChanges(\n    parsedResult.trait_changes ?? reflection.trait_changes\n  );\n\n  const baseEmotionalState = {\n    ...(reflection?.emotional_state && typeof reflection.emotional_state === 'object'\n      ? reflection.emotional_state\n      : {}),\n    ...(parsedResult.emotional_state && typeof parsedResult.emotional_state === 'object'\n      ? parsedResult.emotional_state\n      : {}),\n  };\n  const secondary = toArray(baseEmotionalState.secondary);\n  let intensity = baseEmotionalState.intensity;\n  if (typeof intensity === 'string') {\n    const parsed = parseFloat(intensity);\n    intensity = Number.isFinite(parsed) ? parsed : undefined;\n  }\n  if (typeof intensity === 'number') {\n    intensity = Math.max(0, Math.min(1, intensity));\n  }\n  const emotional_state = {\n    ...baseEmotionalState,\n    ...(typeof intensity === 'number' ? { intensity } : {}),\n    ...(secondary.length > 0 ? { secondary } : {}),\n  };\n\n  return (\n    <div className=\"border border-[var(--color-border)] bg-[var(--color-bg-elev-1)] rounded-lg overflow-hidden transition-all\">\n      {/* Card Header */}\n      <div className=\"p-4 flex justify-between items-center\">\n        <div>\n          <h4 className=\"text-lg font-medium text-[var(--color-accent)]\">\n            {(reflection.reflection_type || reflection.type || 'reflection')\n              .toString()\n              .replace(/^(.)/, (m, c) => c.toUpperCase())} Reflection\n          </h4>\n          <p className=\"text-xs text-gray-400\">{timeAgo}</p>\n        </div>\n        \n        <button \n          onClick={() => setExpanded(!expanded)} \n          className=\"text-[var(--color-accent-strong)] hover:opacity-90 transition-colors\"\n          aria-expanded={expanded}\n        >\n          <span className=\"sr-only\">{expanded ? 'Collapse' : 'Expand'}</span>\n          <svg \n            xmlns=\"http://www.w3.org/2000/svg\" \n            className={`h-5 w-5 transition-transform ${expanded ? 'rotate-180' : ''}`}\n            viewBox=\"0 0 20 20\" \n            fill=\"currentColor\"\n          >\n            <path \n              fillRule=\"evenodd\" \n              d=\"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z\" \n              clipRule=\"evenodd\" \n            />\n          </svg>\n        </button>\n      </div>\n      \n      {/* Preview (always visible) */}\n      <div className=\"px-4 pb-2\">\n        <div className=\"flex flex-wrap gap-2\">\n          {themes.map((theme, i) => (\n            <span \n              key={i} \n              className=\"px-2 py-1 text-xs rounded-full bg-[color:var(--color-accent)/0.08] text-[var(--color-accent)] border border-[var(--color-border)]\"\n            >\n              {formatDisplayLabel(theme)}\n            </span>\n          ))}\n        </div>\n      </div>\n      \n      {/* Expanded content */}\n      {expanded && (\n        <div className=\"p-4 border-t border-[var(--color-border)] mt-2 bg-[var(--color-bg-elev-1)]\">\n          {/* Main reflection content */}\n          <div className=\"space-y-4\">\n            <div className=\"prose prose-sm prose-invert max-w-none whitespace-pre-wrap\">{content}</div>\n            \n            {/* Trait Changes - Shows evolution during this reflection */}\n            {trait_changes.length > 0 && (\n              <div className=\"mt-4 p-3 rounded-md bg-[var(--color-bg-elev-2)] border border-[var(--color-border)]\">\n                <h5 className=\"text-sm font-medium text-[var(--color-accent-strong)] mb-2\">üìä Trait Changes</h5>\n                <div className=\"space-y-1\">\n                  {trait_changes.map((change, i) => {\n                    const traitName = formatDisplayLabel(change.trait || change.name || 'Unknown');\n                    const delta = change.delta || change.change || 0;\n                    const oldVal = change.old_value || change.from;\n                    const newVal = change.new_value || change.to;\n                    const isIncrease = delta > 0;\n                    const isDecrease = delta < 0;\n                    \n                    return (\n                      <div key={i} className=\"flex items-center justify-between text-xs\">\n                        <span className=\"text-[var(--color-text-secondary)]\">{traitName}</span>\n                        <div className=\"flex items-center gap-2\">\n                          {oldVal !== undefined && newVal !== undefined && (\n                            <span className=\"text-[var(--color-text-muted)]\">\n                              {typeof oldVal === 'number' ? oldVal.toFixed(2) : oldVal} ‚Üí {typeof newVal === 'number' ? newVal.toFixed(2) : newVal}\n                            </span>\n                          )}\n                          <span className={`font-medium ${isIncrease ? 'text-green-400' : isDecrease ? 'text-red-400' : 'text-gray-400'}`}>\n                            {isIncrease ? '‚Üë' : isDecrease ? '‚Üì' : '='} {Math.abs(delta).toFixed(3)}\n                          </span>\n                        </div>\n                      </div>\n                    );\n                  })}\n                </div>\n              </div>\n            )}\n            \n            {/* Current Traits (moved from preview to expanded section) */}\n            {topTraits.length > 0 && (\n              <div className=\"mt-4 p-3 rounded-md bg-[var(--color-bg-elev-2)] border border-[var(--color-border)]\">\n                <h5 className=\"text-sm font-medium text-[var(--color-accent-strong)] mb-2\">üè∑Ô∏è Current Traits</h5>\n                <div className=\"flex flex-wrap gap-2\">\n                  {topTraits.map((t, i) => (\n                    <span\n                      key={`${t.name}-${i}`}\n                      title={t.category ? `${t.name} ‚Ä¢ ${t.category}` : t.name}\n                      className=\"px-2 py-0.5 text-[10px] rounded-full bg-[var(--color-bg-elev-2)] text-[var(--color-text-secondary)] border border-[var(--color-border)]\"\n                    >\n                      {formatDisplayLabel(t.name)}\n                      {typeof t.value === 'number' && (\n                        <>\n                          {\" \"}\n                          <span className=\"text-[var(--color-accent)]\">{(t.value).toFixed(2)}</span>\n                        </>\n                      )}\n                    </span>\n                  ))}\n                </div>\n              </div>\n            )}\n            \n            {/* Emotional state */}\n            {emotional_state && Object.keys(emotional_state).length > 0 && (\n              <div className=\"mt-4 p-3 rounded-md bg-[var(--color-bg-elev-2)] border border-[var(--color-border)]\">\n                <h5 className=\"text-sm font-medium text-[var(--color-accent-strong)] mb-2\">Emotional State</h5>\n                <div className=\"grid grid-cols-2 gap-2 text-xs\">\n                  {emotional_state.primary && (\n                    <div>\n                      <span className=\"text-[var(--color-text-muted)]\">Primary:</span>{\" \"}\n                      <span className=\"text-[var(--color-text-primary)]\">{formatDisplayLabel(emotional_state.primary)}</span>\n                    </div>\n                  )}\n                  {emotional_state.intensity !== undefined && (\n                    <div>\n                      <span className=\"text-[var(--color-text-muted)]\">Intensity:</span>{\" \"}\n                      <span className=\"text-[var(--color-text-primary)]\">{(emotional_state.intensity * 100).toFixed(0)}%</span>\n                    </div>\n                  )}\n                  {emotional_state.secondary?.length > 0 && (\n                    <div className=\"col-span-2\">\n                      <span className=\"text-[var(--color-text-muted)]\">Secondary:</span>{\" \"}\n                      <span className=\"text-[var(--color-text-primary)]\">{emotional_state.secondary.map(formatDisplayLabel).join(', ')}</span>\n                    </div>\n                  )}\n                  {emotional_state.trend && (\n                    <div className=\"col-span-2\">\n                      <span className=\"text-[var(--color-text-muted)]\">Trend:</span>{\" \"}\n                      <span className=\"text-[var(--color-text-primary)]\">{formatDisplayLabel(emotional_state.trend)}</span>\n                    </div>\n                  )}\n                </div>\n              </div>\n            )}\n            \n            {/* Insights and Actions */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4\">\n              {insights.length > 0 && (\n                <div className=\"p-3 rounded-md bg-[var(--color-bg-elev-2)] border border-[var(--color-border)]\">\n                  <h5 className=\"text-sm font-medium text-[var(--color-accent)] mb-2\">Key Insights</h5>\n                  <ul className=\"list-disc list-inside text-xs space-y-1 text-[var(--color-text-secondary)]\">\n                    {insights.map((insight, i) => (\n                      <li key={i}>{insight}</li>\n                    ))}\n                  </ul>\n                </div>\n              )}\n              \n              {actions.length > 0 && (\n                <div className=\"p-3 rounded-md bg-[var(--color-bg-elev-2)] border border-[var(--color-border)]\">\n                  <h5 className=\"text-sm font-medium text-[var(--color-accent-strong)] mb-2\">Suggested Actions</h5>\n                  <ul className=\"list-disc list-inside text-xs space-y-1 text-[var(--color-text-secondary)]\">\n                    {actions.map((action, i) => (\n                      <li key={i}>{action}</li>\n                    ))}\n                  </ul>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n      \n      {/* Card Footer */}\n      <div className=\"p-3 bg-[var(--color-bg-elev-1)] border-t border-[var(--color-border)] flex justify-between items-center\">\n        {reflection.id && (\n          <span className=\"text-xs text-[var(--color-text-muted)]\">\n            ID: {reflection.id.substring(0, 8)}\n          </span>\n        )}\n        \n        <button \n          onClick={() => setExpanded(!expanded)} \n          className=\"text-xs text-[var(--color-accent)] hover:opacity-90 transition-colors\"\n        >\n          {expanded ? 'Show Less' : 'Show More'}\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default ReflectionCard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}